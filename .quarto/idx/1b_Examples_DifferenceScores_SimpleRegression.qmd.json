{"title":"Difference Scores: Simple Regression","markdown":{"yaml":{"title":"Difference Scores: Simple Regression","author":"Biostatistics Working Group"},"headingText":"Simple Regression","headingAttr":{"id":"","classes":["unnumbered"],"keyvalue":[]},"containsRefs":false,"markdown":"\n\n\n## Overview\n\n<p>\n\nThis example assesses whether growth in a subsample of ABCD participants from Baseline (T0) to the 1-Year follow-up (T1) differs significantly based on handedness, using height (\"anthroheightcalc\") as a representative metric of growth. The analysis is conducted in two primary steps: 1) a difference score is calculated between baseline and Year_1 height measurements for each participant; 2) a simple regression analysis is used to test whether sex (boy, girl) predicts the average difference value in participants height from baseline to the 1-Year follow-up. Finally, a visual inspection is further conducted via a violin plot to graphically represent the relationship between difference scores and sex. The ensuing analysis and interpretations are detailed in the subsequent sections.\n\n</p>\n\n## Preliminary Setup\n\n::: panel-tabset\n### Install Packages {.tabset .tabset-fade .tabset-pills}\n\n::: blue\n> **This code installs the r packages necessary for this example, if\n> they are not already installed**\n\n```{r pckg-install}\n#| echo: TRUE\n#| messages: FALSE\n#| warning: FALSE\n#| output: FALSE\n\n# rm(list = ls())\n\n# Create a list of required packages\npackages_required <- c(\"tidyverse\",\"rstatix\",\"DT\",\"gtsummary\",\"easystats\")\n\n# Check which packages are not installed and install them\npackages_to_install <- setdiff(packages_required, rownames(installed.packages()))\nif (length(packages_to_install) > 0) {\n    install.packages(packages_to_install)\n}\n\n# Load the required packages\nlapply(packages_required, library, character.only = TRUE)\n\n```\n:::\n\n### Load Packages\n\n::: blue\n**This code loads the r libraries necessary for this example**\n\n```{r lib-load}\n#| echo: TRUE\n#| messages: FALSE\n#| warning: FALSE\n#| output: FALSE\n\nlibrary(tidyverse)    # Collection of R packages for data science\nlibrary(rstatix)      # Pipe-friendly framework for basic statistical tests\nlibrary(DT)           # Rendering interactive data tables\nlibrary(gtsummary)    # \nlibrary(easystats)    # \n\n```\n:::\n\n### Config Options\n\n::: blue\n**This code configures knitr code chunk options**\n\n```{r config}\n#| echo: TRUE\n#| messages: FALSE\n#| warning: FALSE\n#| output: FALSE\n\nknitr::opts_chunk$set(echo = T, message=F, warning=F, error=F, \n                      comment=NA, cache=T, code_folding=T,\n                      R.options=list(width=220, digits = 3),\n                      fig.align='center', \n                      out.width='75%', fig.asp=.75)\n```\n:::\n:::\n\n## Descriptives Overview\n\n::: panel-tabset\n### Read and View Data {.tabset .tabset-fade .tabset-pills}\n\n::: blue\n**This code reads in and shows the data to be used in the current\nexample**\n\n```{r read-data}\n#| echo: TRUE\n#| messages: FALSE\n#| warning: FALSE\n#| output: FALSE\n#| cache: FALSE\n\n# Set the data paths\ndata_path_1 <- \"/Users/shawes/ABCD/data/rds/abcd_5.0_rds/demo5.0.rds\"\ndata_path_2 <- \"/Users/shawes/ABCD/data/rds/abcd_5.0_rds/core-rds-5.0/non-imaging_excluding_nt_5.0.rds\"\n\n# Read the data\ndata_demographics <- readRDS(data_path_1)\ndata_nonimaging <- readRDS(data_path_2)\n\n# Subset the nonimaging data to include desired variables\nselected_vars <- c(\"src_subject_id\", \"eventname\", \"nihtbx_totalcomp_fc\", \"anthroweightcalc\", \"anthroheightcalc\")\nsubset_data <- data_nonimaging[, selected_vars]\n\nlibrary(dplyr)\n# # Merge the datasets on 'src_subject_id' and 'eventname'\nmerged_data <- data_demographics %>%\n  full_join(subset_data, by = c(\"src_subject_id\", \"eventname\"))\n\n# Inspect the merged data structure\nstr(merged_data)\n\n# Define event names to be retained in the analysis and convert variables to appropriate data types\neventnames_to_include <- c(\"baseline_year_1_arm_1\",\n                           \"1_year_follow_up_y_arm_1\",\n                           \"2_year_follow_up_y_arm_1\",\n                           \"3_year_follow_up_y_arm_1\",\n                           \"4_year_follow_up_y_arm_1\")\n\ndf <- merged_data %>%\n  filter(eventname %in% eventnames_to_include) %>%\n  mutate(\n    src_subject_id = as.factor(src_subject_id),\n    eventname = factor(eventname, levels = eventnames_to_include, ordered = TRUE),\n    age = as.numeric(age),\n    sex = as.factor(sex),\n    race.4level = as.factor(race.4level),\n    hisp = as.factor(hisp),\n    high.educ.bl = as.factor(high.educ.bl),\n    household.income.bl = as.factor(household.income.bl),\n    acs_raked_propensity_score = as.numeric(acs_raked_propensity_score),\n    rel_family_id.bl = as.factor(rel_family_id.bl),\n    site_id_l = as.factor(site_id_l),\n    nihtbx_totalcomp_fc = as.numeric(nihtbx_totalcomp_fc),\n    anthroweightcalc = as.numeric(anthroweightcalc),\n    anthroheightcalc = as.numeric(anthroheightcalc)\n  ) %>%\n  # Exclude cases from unused assessment waves\n  filter(!is.na(eventname))\n\n```\n:::\n\n### Descriptives\n\n::: blue\n**This code creates a descriptives table**\n\n```{r descriptives}\n#| echo: TRUE\n#| messages: FALSE\n#| warning: FALSE\n\ndescriptives_table <- df %>%\n  select(eventname, sex, race.4level, hisp, anthroweightcalc) %>%\n  mutate(eventname = factor(eventname, labels = c(\"Baseline\", \"Year 1\",\"Year 2\",\"Year 3\",\"Year 4\"))) %>%\n  mutate(sex = factor(sex, labels = c(\"Female\", \"Male\"))) %>%\n  tbl_summary(\n    by = eventname,\n    missing = \"no\",\n    label = list(sex ~ \"Sex\", race.4level ~ \"Race\", hisp ~ \"Hispanic\", \n                 anthroweightcalc ~ \"Weight\"),\n    statistic = list(all_continuous() ~ \"{mean} ({sd}) )\", all_categorical() ~ \"{p}%\"),\n  ) %>%\nmodify_header(all_stat_cols() ~ \"**{level}**<br>N = {n}\") %>%\n  bold_labels() %>%\n  italicize_levels() %>%\n  modify_spanning_header(all_stat_cols() ~ \"**Assessment Wave**\")\ntheme_gtsummary_compact()\n\ndescriptives_table\n```\n\n:::\n:::\n\n## Results\n\n::: panel-tabset\n### Build Model: Step 1 {.tabset .tabset-fade .tabset-pills}\n\n::: blue\nThe code snippet below tells R to compute a difference score by subtracting each participant’s height at T1 from their height at T0. Relevant summary statistics are also provided.\n\n**STEP 1: Compute Difference Score**\n```{r build-model-regression-1}\n#| message: FALSE\n#| warning: FALSE\n#| echo: TRUE\n#| class.source: 'fold-hide'\n\n# Define the function to compute difference scores for a given variable and provide a summary\n# Function to compute difference scores for a given variable and provide a summary\ncompute_difference_and_summary <- function(df, variable_name) {\n    # Define the event names of interest\n    baseline_event <- \"baseline_year_1_arm_1\"\n    followup_event <- \"1_year_follow_up_y_arm_1\"\n\n    # Compute the difference between Baseline and Year 1 data for the given variable\n    diff_data <- df %>%\n        filter(eventname %in% c(baseline_event, followup_event)) %>% # Filter for specific event names\n        select(src_subject_id, eventname, all_of(variable_name)) %>% # Select required columns\n        spread(eventname, variable_name) %>% # Convert data from long to wide format\n        mutate(diff = get(followup_event) - get(baseline_event)) %>% # Compute difference between the two time points\n        drop_na(diff) # Exclude rows with NA in the computed difference\n\n    # Summarize the computed difference scores\n    diff_summary <- summary(diff_data$diff)\n\n    # Return the difference data and its summary\n    list(data = diff_data, summary = diff_summary)\n}\n\n# List of variables for which difference scores are to be computed\nvariables_of_interest <- c(\"anthroheightcalc\")\n\n# Compute and store difference scores and summaries for each variable in a list\ndifference_and_summary_list <- lapply(variables_of_interest, function(var) {\n    compute_difference_and_summary(df, var)\n})\n\n# Extract the difference data for the 'anthroheightcalc' variable\nheight_diff_data <- difference_and_summary_list[[1]]$data\n\n# Merge the 'diff' column back to the main df using 'src_subject_id' as the key\ndf <- left_join(df, height_diff_data %>% select(src_subject_id, diff), by = \"src_subject_id\")\n\n```\n\n**Descriptive Statistics for the Difference Score**\n```{r model-checking}\n# Compute statistical summaries for the difference score variable\nlapply(difference_and_summary_list, function(item) {\n    print(item$summary)\n})\n```\n\nThis summary of the difference score variable indicates that the differences range from a decrease of `r min(height_diff_data$diff, na.rm = TRUE)` units to an increase of `r max(height_diff_data$diff, na.rm = TRUE)` units. The median difference is `r median(height_diff_data$diff, na.rm = TRUE)` units, and the average difference is approximately `r mean(height_diff_data$diff, digits = 2, na.rm = TRUE)` units. There are `r sum(is.na(height_diff_data$diff))` missing values in this difference score dataset.\n\n**Descriptive Statistics for the Height Variable**\n```{r}\n## Summary statistics\n# Compute summary statistics for Height by eventname\nsummary <- df %>%\n    group_by(eventname) %>%\n    get_summary_stats(anthroheightcalc, type = \"mean_sd\")\n\ndata.frame(summary)\n```\n\nThe summary statistics provide insights into the Height variable across different `eventname` categories. At baseline, the average height is approximately `r summary$mean[summary$eventname == \"baseline_year_1_arm_1\"]` units with a standard deviation of `r summary$sd[summary$eventname == \"baseline_year_1_arm_1\"]`. Over the years, there’s a noticeable increase in average height: by the first year, it’s about `r summary$mean[summary$eventname == \"1_year_follow_up_y_arm_1\"]` units, and it continues to rise, reaching approximately `r summary$mean[summary$eventname == \"4_year_follow_up_y_arm_1\"]` units by the fourth year. The standard deviation remains relatively consistent over the years, suggesting similar variability in height measurements across these time points.\n\n:::\n\n### Build Model: Step 2 {.tabset .tabset-fade .tabset-pills}\n\n::: blue\nA simple regression analyses is conducted to examine whether a grouping variable (sex) significantly predicts the difference score value (indicating significant group differences in the average difference score).\n\n**STEP 2: Conduct regression on Difference Score**\n```{r build-model-regression-2}\n#| class.source: 'fold-hide'\n#| message: FALSE\n#| warning: FALSE\n#| echo: TRUE\n\n# Merge the 'sex' variable from the original dataframe 'df' to 'height_diff_data'\nmerged_data <- height_diff_data %>%\n  left_join(df %>% select(src_subject_id, sex), by = \"src_subject_id\")\n\n# Ensure 'sex' is a factor\nmerged_data$sex <- as.factor(merged_data$sex)\n\n# Run the regression\nmodel <- lm(diff ~ sex, data = merged_data)\n\n# Get the summary of the regression model\nmodel_summary <- summary(model)\n\nmodel_summary\n\n```\n\nThis regression analysis evaluates whether sex (boy, girl) predicts the average difference in participants' height from baseline to the 1-Year follow-up. The output from our model provides: \n\ni. an F-statistic of `r model_summary$fstatistic[1]`; \nii. degrees of freedom of `r model_summary$df[2]`; \niii. a parameter estimate of `r model_summary$coefficients[\"sexMale or other\", \"Estimate\"]`; \niv. standard error of `r model_summary$coefficients[\"sexMale or other\", \"Std. Error\"]`; \nv. p-value of `r model_summary$coefficients[\"sexMale or other\", \"Pr(>|t|)\"]`. \n\nCompared to boys (the reference group), girls have an average increase in height difference of approximately `r round(model_summary$coefficients[\"sexMale or other\", \"Estimate\"], 3)` units. This effect was marginally significant with a p-value of `r round(model_summary$coefficients[\"sexMale or other\", \"Pr(>|t|)\"], 4)`. Overall, the model explained a very small portion of the variance in height difference, with an adjusted R-squared value of `r round(model_summary$adj.r.squared, 6)`, and the overall model significance was not statistically significant with a p-value of `r pf(model_summary$fstatistic[1], model_summary$fstatistic[2], model_summary$fstatistic[3], lower.tail = FALSE)`.\n\n:::\n\n### Model Plots\n\n::: blue\n```{r violin-plots}\n#| echo: TRUE\n#| messages: FALSE\n#| warning: FALSE\n#| code-summary: testing\n\n# Visualize the difference scores across different levels of sex\n\n# Create a violin plot to show the distribution of difference scores by sex\n# Jittered points are added to provide a more granular view of individual observations\n# Load necessary libraries\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n# Merge the 'sex' variable from the original dataframe 'df' to 'height_diff_data'\nmerged_data <- height_diff_data %>%\n  left_join(df %>% select(src_subject_id, sex), by = \"src_subject_id\")\n\n# Plotting using ggplot2\nggplot(merged_data, aes(x = sex, y = diff, fill = sex)) +\n  geom_violin() +\n  geom_jitter(position = position_jitter(width = 0.2), size = 1, alpha = 0.5) +\n  scale_fill_brewer(palette = \"Set2\") + \n  labs(\n    title = \"Difference Scores by Sex\",\n    x = \"Sex\",\n    y = \"Difference Score\"\n  ) +\n  theme_minimal() + \n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    legend.position = \"none\"\n  )\n\n\n\n```\n\nThe violin plot visualizes the distribution of difference scores in children's heights by their sex: Right, Left, and Mixed. Each violin shape provides insight into the density of the data at different height differences, with wider sections representing higher densities of data points. Superimposed jittered points offer a granular view of individual observations. From the plot, it appears that the distributions of height differences across the three handedness categories are somewhat similar, though there might be subtle variations in median and spread.\n\n:::\n:::\n\n## Wrapping Up\n\n::: panel-tabset\n### Write-up {.tabset .tabset-fade .tabset-pills}\n\n::: blue\nDifferences in children's heights between baseline and a subsequent 1-year follow-up, we sought to understand the potential influence of sex on this difference. Descriptive statistics revealed that height differences ranged from a decrease of `r min(merged_data$diff, na.rm = TRUE)` units to an increase of `r max(merged_data$diff, na.rm = TRUE)` units, with a median difference of `r median(merged_data$diff, na.rm = TRUE)` units and an average difference of approximately `r mean(merged_data$diff, na.rm = TRUE)` units. Subsequent regression analysis indicated that, when compared to boys, girls had an average increase in height difference of approximately `r round(model_summary$coefficients[\"sexMale or other\", \"Estimate\"], 3)` units, though this effect was marginally significant (p = `r round(model_summary$coefficients[\"sexMale or other\", \"Pr(>|t|)\"], 4)`). Complementary to these findings, violin plots visually underscored the subtle variations in height differences across sex categories, suggesting broadly similar distributions but with nuanced variations in central tendency and spread. In conclusion, while sex exhibited a potential influence on height difference over the year, the observed effect was notably minor.\n\n\n:::\n:::","srcMarkdownNoYaml":"\n\n# Simple Regression {.unnumbered}\n\n## Overview\n\n<p>\n\nThis example assesses whether growth in a subsample of ABCD participants from Baseline (T0) to the 1-Year follow-up (T1) differs significantly based on handedness, using height (\"anthroheightcalc\") as a representative metric of growth. The analysis is conducted in two primary steps: 1) a difference score is calculated between baseline and Year_1 height measurements for each participant; 2) a simple regression analysis is used to test whether sex (boy, girl) predicts the average difference value in participants height from baseline to the 1-Year follow-up. Finally, a visual inspection is further conducted via a violin plot to graphically represent the relationship between difference scores and sex. The ensuing analysis and interpretations are detailed in the subsequent sections.\n\n</p>\n\n## Preliminary Setup\n\n::: panel-tabset\n### Install Packages {.tabset .tabset-fade .tabset-pills}\n\n::: blue\n> **This code installs the r packages necessary for this example, if\n> they are not already installed**\n\n```{r pckg-install}\n#| echo: TRUE\n#| messages: FALSE\n#| warning: FALSE\n#| output: FALSE\n\n# rm(list = ls())\n\n# Create a list of required packages\npackages_required <- c(\"tidyverse\",\"rstatix\",\"DT\",\"gtsummary\",\"easystats\")\n\n# Check which packages are not installed and install them\npackages_to_install <- setdiff(packages_required, rownames(installed.packages()))\nif (length(packages_to_install) > 0) {\n    install.packages(packages_to_install)\n}\n\n# Load the required packages\nlapply(packages_required, library, character.only = TRUE)\n\n```\n:::\n\n### Load Packages\n\n::: blue\n**This code loads the r libraries necessary for this example**\n\n```{r lib-load}\n#| echo: TRUE\n#| messages: FALSE\n#| warning: FALSE\n#| output: FALSE\n\nlibrary(tidyverse)    # Collection of R packages for data science\nlibrary(rstatix)      # Pipe-friendly framework for basic statistical tests\nlibrary(DT)           # Rendering interactive data tables\nlibrary(gtsummary)    # \nlibrary(easystats)    # \n\n```\n:::\n\n### Config Options\n\n::: blue\n**This code configures knitr code chunk options**\n\n```{r config}\n#| echo: TRUE\n#| messages: FALSE\n#| warning: FALSE\n#| output: FALSE\n\nknitr::opts_chunk$set(echo = T, message=F, warning=F, error=F, \n                      comment=NA, cache=T, code_folding=T,\n                      R.options=list(width=220, digits = 3),\n                      fig.align='center', \n                      out.width='75%', fig.asp=.75)\n```\n:::\n:::\n\n## Descriptives Overview\n\n::: panel-tabset\n### Read and View Data {.tabset .tabset-fade .tabset-pills}\n\n::: blue\n**This code reads in and shows the data to be used in the current\nexample**\n\n```{r read-data}\n#| echo: TRUE\n#| messages: FALSE\n#| warning: FALSE\n#| output: FALSE\n#| cache: FALSE\n\n# Set the data paths\ndata_path_1 <- \"/Users/shawes/ABCD/data/rds/abcd_5.0_rds/demo5.0.rds\"\ndata_path_2 <- \"/Users/shawes/ABCD/data/rds/abcd_5.0_rds/core-rds-5.0/non-imaging_excluding_nt_5.0.rds\"\n\n# Read the data\ndata_demographics <- readRDS(data_path_1)\ndata_nonimaging <- readRDS(data_path_2)\n\n# Subset the nonimaging data to include desired variables\nselected_vars <- c(\"src_subject_id\", \"eventname\", \"nihtbx_totalcomp_fc\", \"anthroweightcalc\", \"anthroheightcalc\")\nsubset_data <- data_nonimaging[, selected_vars]\n\nlibrary(dplyr)\n# # Merge the datasets on 'src_subject_id' and 'eventname'\nmerged_data <- data_demographics %>%\n  full_join(subset_data, by = c(\"src_subject_id\", \"eventname\"))\n\n# Inspect the merged data structure\nstr(merged_data)\n\n# Define event names to be retained in the analysis and convert variables to appropriate data types\neventnames_to_include <- c(\"baseline_year_1_arm_1\",\n                           \"1_year_follow_up_y_arm_1\",\n                           \"2_year_follow_up_y_arm_1\",\n                           \"3_year_follow_up_y_arm_1\",\n                           \"4_year_follow_up_y_arm_1\")\n\ndf <- merged_data %>%\n  filter(eventname %in% eventnames_to_include) %>%\n  mutate(\n    src_subject_id = as.factor(src_subject_id),\n    eventname = factor(eventname, levels = eventnames_to_include, ordered = TRUE),\n    age = as.numeric(age),\n    sex = as.factor(sex),\n    race.4level = as.factor(race.4level),\n    hisp = as.factor(hisp),\n    high.educ.bl = as.factor(high.educ.bl),\n    household.income.bl = as.factor(household.income.bl),\n    acs_raked_propensity_score = as.numeric(acs_raked_propensity_score),\n    rel_family_id.bl = as.factor(rel_family_id.bl),\n    site_id_l = as.factor(site_id_l),\n    nihtbx_totalcomp_fc = as.numeric(nihtbx_totalcomp_fc),\n    anthroweightcalc = as.numeric(anthroweightcalc),\n    anthroheightcalc = as.numeric(anthroheightcalc)\n  ) %>%\n  # Exclude cases from unused assessment waves\n  filter(!is.na(eventname))\n\n```\n:::\n\n### Descriptives\n\n::: blue\n**This code creates a descriptives table**\n\n```{r descriptives}\n#| echo: TRUE\n#| messages: FALSE\n#| warning: FALSE\n\ndescriptives_table <- df %>%\n  select(eventname, sex, race.4level, hisp, anthroweightcalc) %>%\n  mutate(eventname = factor(eventname, labels = c(\"Baseline\", \"Year 1\",\"Year 2\",\"Year 3\",\"Year 4\"))) %>%\n  mutate(sex = factor(sex, labels = c(\"Female\", \"Male\"))) %>%\n  tbl_summary(\n    by = eventname,\n    missing = \"no\",\n    label = list(sex ~ \"Sex\", race.4level ~ \"Race\", hisp ~ \"Hispanic\", \n                 anthroweightcalc ~ \"Weight\"),\n    statistic = list(all_continuous() ~ \"{mean} ({sd}) )\", all_categorical() ~ \"{p}%\"),\n  ) %>%\nmodify_header(all_stat_cols() ~ \"**{level}**<br>N = {n}\") %>%\n  bold_labels() %>%\n  italicize_levels() %>%\n  modify_spanning_header(all_stat_cols() ~ \"**Assessment Wave**\")\ntheme_gtsummary_compact()\n\ndescriptives_table\n```\n\n:::\n:::\n\n## Results\n\n::: panel-tabset\n### Build Model: Step 1 {.tabset .tabset-fade .tabset-pills}\n\n::: blue\nThe code snippet below tells R to compute a difference score by subtracting each participant’s height at T1 from their height at T0. Relevant summary statistics are also provided.\n\n**STEP 1: Compute Difference Score**\n```{r build-model-regression-1}\n#| message: FALSE\n#| warning: FALSE\n#| echo: TRUE\n#| class.source: 'fold-hide'\n\n# Define the function to compute difference scores for a given variable and provide a summary\n# Function to compute difference scores for a given variable and provide a summary\ncompute_difference_and_summary <- function(df, variable_name) {\n    # Define the event names of interest\n    baseline_event <- \"baseline_year_1_arm_1\"\n    followup_event <- \"1_year_follow_up_y_arm_1\"\n\n    # Compute the difference between Baseline and Year 1 data for the given variable\n    diff_data <- df %>%\n        filter(eventname %in% c(baseline_event, followup_event)) %>% # Filter for specific event names\n        select(src_subject_id, eventname, all_of(variable_name)) %>% # Select required columns\n        spread(eventname, variable_name) %>% # Convert data from long to wide format\n        mutate(diff = get(followup_event) - get(baseline_event)) %>% # Compute difference between the two time points\n        drop_na(diff) # Exclude rows with NA in the computed difference\n\n    # Summarize the computed difference scores\n    diff_summary <- summary(diff_data$diff)\n\n    # Return the difference data and its summary\n    list(data = diff_data, summary = diff_summary)\n}\n\n# List of variables for which difference scores are to be computed\nvariables_of_interest <- c(\"anthroheightcalc\")\n\n# Compute and store difference scores and summaries for each variable in a list\ndifference_and_summary_list <- lapply(variables_of_interest, function(var) {\n    compute_difference_and_summary(df, var)\n})\n\n# Extract the difference data for the 'anthroheightcalc' variable\nheight_diff_data <- difference_and_summary_list[[1]]$data\n\n# Merge the 'diff' column back to the main df using 'src_subject_id' as the key\ndf <- left_join(df, height_diff_data %>% select(src_subject_id, diff), by = \"src_subject_id\")\n\n```\n\n**Descriptive Statistics for the Difference Score**\n```{r model-checking}\n# Compute statistical summaries for the difference score variable\nlapply(difference_and_summary_list, function(item) {\n    print(item$summary)\n})\n```\n\nThis summary of the difference score variable indicates that the differences range from a decrease of `r min(height_diff_data$diff, na.rm = TRUE)` units to an increase of `r max(height_diff_data$diff, na.rm = TRUE)` units. The median difference is `r median(height_diff_data$diff, na.rm = TRUE)` units, and the average difference is approximately `r mean(height_diff_data$diff, digits = 2, na.rm = TRUE)` units. There are `r sum(is.na(height_diff_data$diff))` missing values in this difference score dataset.\n\n**Descriptive Statistics for the Height Variable**\n```{r}\n## Summary statistics\n# Compute summary statistics for Height by eventname\nsummary <- df %>%\n    group_by(eventname) %>%\n    get_summary_stats(anthroheightcalc, type = \"mean_sd\")\n\ndata.frame(summary)\n```\n\nThe summary statistics provide insights into the Height variable across different `eventname` categories. At baseline, the average height is approximately `r summary$mean[summary$eventname == \"baseline_year_1_arm_1\"]` units with a standard deviation of `r summary$sd[summary$eventname == \"baseline_year_1_arm_1\"]`. Over the years, there’s a noticeable increase in average height: by the first year, it’s about `r summary$mean[summary$eventname == \"1_year_follow_up_y_arm_1\"]` units, and it continues to rise, reaching approximately `r summary$mean[summary$eventname == \"4_year_follow_up_y_arm_1\"]` units by the fourth year. The standard deviation remains relatively consistent over the years, suggesting similar variability in height measurements across these time points.\n\n:::\n\n### Build Model: Step 2 {.tabset .tabset-fade .tabset-pills}\n\n::: blue\nA simple regression analyses is conducted to examine whether a grouping variable (sex) significantly predicts the difference score value (indicating significant group differences in the average difference score).\n\n**STEP 2: Conduct regression on Difference Score**\n```{r build-model-regression-2}\n#| class.source: 'fold-hide'\n#| message: FALSE\n#| warning: FALSE\n#| echo: TRUE\n\n# Merge the 'sex' variable from the original dataframe 'df' to 'height_diff_data'\nmerged_data <- height_diff_data %>%\n  left_join(df %>% select(src_subject_id, sex), by = \"src_subject_id\")\n\n# Ensure 'sex' is a factor\nmerged_data$sex <- as.factor(merged_data$sex)\n\n# Run the regression\nmodel <- lm(diff ~ sex, data = merged_data)\n\n# Get the summary of the regression model\nmodel_summary <- summary(model)\n\nmodel_summary\n\n```\n\nThis regression analysis evaluates whether sex (boy, girl) predicts the average difference in participants' height from baseline to the 1-Year follow-up. The output from our model provides: \n\ni. an F-statistic of `r model_summary$fstatistic[1]`; \nii. degrees of freedom of `r model_summary$df[2]`; \niii. a parameter estimate of `r model_summary$coefficients[\"sexMale or other\", \"Estimate\"]`; \niv. standard error of `r model_summary$coefficients[\"sexMale or other\", \"Std. Error\"]`; \nv. p-value of `r model_summary$coefficients[\"sexMale or other\", \"Pr(>|t|)\"]`. \n\nCompared to boys (the reference group), girls have an average increase in height difference of approximately `r round(model_summary$coefficients[\"sexMale or other\", \"Estimate\"], 3)` units. This effect was marginally significant with a p-value of `r round(model_summary$coefficients[\"sexMale or other\", \"Pr(>|t|)\"], 4)`. Overall, the model explained a very small portion of the variance in height difference, with an adjusted R-squared value of `r round(model_summary$adj.r.squared, 6)`, and the overall model significance was not statistically significant with a p-value of `r pf(model_summary$fstatistic[1], model_summary$fstatistic[2], model_summary$fstatistic[3], lower.tail = FALSE)`.\n\n:::\n\n### Model Plots\n\n::: blue\n```{r violin-plots}\n#| echo: TRUE\n#| messages: FALSE\n#| warning: FALSE\n#| code-summary: testing\n\n# Visualize the difference scores across different levels of sex\n\n# Create a violin plot to show the distribution of difference scores by sex\n# Jittered points are added to provide a more granular view of individual observations\n# Load necessary libraries\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\n\n# Merge the 'sex' variable from the original dataframe 'df' to 'height_diff_data'\nmerged_data <- height_diff_data %>%\n  left_join(df %>% select(src_subject_id, sex), by = \"src_subject_id\")\n\n# Plotting using ggplot2\nggplot(merged_data, aes(x = sex, y = diff, fill = sex)) +\n  geom_violin() +\n  geom_jitter(position = position_jitter(width = 0.2), size = 1, alpha = 0.5) +\n  scale_fill_brewer(palette = \"Set2\") + \n  labs(\n    title = \"Difference Scores by Sex\",\n    x = \"Sex\",\n    y = \"Difference Score\"\n  ) +\n  theme_minimal() + \n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    legend.position = \"none\"\n  )\n\n\n\n```\n\nThe violin plot visualizes the distribution of difference scores in children's heights by their sex: Right, Left, and Mixed. Each violin shape provides insight into the density of the data at different height differences, with wider sections representing higher densities of data points. Superimposed jittered points offer a granular view of individual observations. From the plot, it appears that the distributions of height differences across the three handedness categories are somewhat similar, though there might be subtle variations in median and spread.\n\n:::\n:::\n\n## Wrapping Up\n\n::: panel-tabset\n### Write-up {.tabset .tabset-fade .tabset-pills}\n\n::: blue\nDifferences in children's heights between baseline and a subsequent 1-year follow-up, we sought to understand the potential influence of sex on this difference. Descriptive statistics revealed that height differences ranged from a decrease of `r min(merged_data$diff, na.rm = TRUE)` units to an increase of `r max(merged_data$diff, na.rm = TRUE)` units, with a median difference of `r median(merged_data$diff, na.rm = TRUE)` units and an average difference of approximately `r mean(merged_data$diff, na.rm = TRUE)` units. Subsequent regression analysis indicated that, when compared to boys, girls had an average increase in height difference of approximately `r round(model_summary$coefficients[\"sexMale or other\", \"Estimate\"], 3)` units, though this effect was marginally significant (p = `r round(model_summary$coefficients[\"sexMale or other\", \"Pr(>|t|)\"], 4)`). Complementary to these findings, violin plots visually underscored the subtle variations in height differences across sex categories, suggesting broadly similar distributions but with nuanced variations in central tendency and spread. In conclusion, while sex exhibited a potential influence on height difference over the year, the observed effect was notably minor.\n\n\n:::\n:::"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"paged","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"message":false,"cold-folding":true,"R.options":"list(width=220)","fig.align":"center","out.width":"75%","fig.asp":0.75,"dev":"cairo_pdf","engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":true,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":true,"link-external-newwindow":true,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"toc-depth":1,"html-math-method":"katex","output-file":"1b_Examples_DifferenceScores_SimpleRegression.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","bibliography":["references.bib"],"comments":{"hypothesis":true},"theme":"styles.scss","toc-expand":3,"toc-title":"Table of Contents","anchor-sections":true,"smooth-scroll":true,"linestretch":1.5,"code-copy":true,"code-summary":"Code","code-block-bg":true,"code-block-border-left":"#31BAE9","options":"max.print=75000","grid":{"sidebar-width":"425px"},"title":"Difference Scores: Simple Regression","author":"Biostatistics Working Group"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}
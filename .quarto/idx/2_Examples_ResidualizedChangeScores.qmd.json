{"title":"Residualized Change Scores","markdown":{"yaml":{"title":"Residualized Change Scores","author":"Biostatistics Working Group"},"headingText":"Mulitple Regression","headingAttr":{"id":"","classes":["unnumbered"],"keyvalue":[]},"containsRefs":false,"markdown":"\n\n\n## Overview\n\n<p>\n\nThis example assesses whether height, measured at the 1-Year follow-up (T1) in a subsample of ABCD participants, is predicted by weight and height measured at baseline (T0). A visual inspection is further conducted via a scatterplot to graphically represent the relationship between height at Year_1 and weight at baseline, controlling for height at baseline. The ensuing analysis and interpretations are detailed in the subsequent sections.\n\n</p>\n\n## Preliminary Setup\n\n::: panel-tabset\n### Install Packages {.tabset .tabset-fade .tabset-pills}\n\n::: blue\n> **This code installs the r packages necessary for this example, if\n> they are not already installed**\n\n```{r pckg-install}\n#| echo: TRUE\n#| messages: FALSE\n#| warning: FALSE\n#| output: FALSE\n\n# Create a list of required packages\npackages_required <- c(\"tidyverse\",\"rstatix\",\"DT\",\"lme4\")\n\n# Check which packages are not installed and install them\npackages_to_install <- setdiff(packages_required, rownames(installed.packages()))\nif (length(packages_to_install) > 0) {\n    install.packages(packages_to_install)\n}\n\n# Load the required packages\nlapply(packages_required, library, character.only = TRUE)\n\n```\n:::\n\n### Load Packages\n\n::: blue\n**This code loads the r libraries necessary for this example**\n\n```{r lib-load}\n#| echo: TRUE\n#| messages: FALSE\n#| warning: FALSE\n#| output: FALSE\n\nlibrary(tidyverse)    # Collection of R packages for data science\nlibrary(rstatix)      # Pipe-friendly framework for basic statistical tests\nlibrary(DT)           # Rendering interactive data tables\nlibrary(lme4)         # Linear mixed-effects models\n\n```\n:::\n\n### Config Options\n\n::: blue\n**This code configures knitr code chunk options**\n\n```{r config}\n#| echo: TRUE\n#| messages: FALSE\n#| warning: FALSE\n#| output: FALSE\n\nknitr::opts_chunk$set(echo = T, message=F, warning=F, error=F, \n                      comment=NA, cache=T, code_folding=T,\n                      R.options=list(width=220, digits = 3),\n                      fig.align='center', \n                      out.width='75%', fig.asp=.75)\n```\n:::\n:::\n\n## Descriptives Overview\n\n::: panel-tabset\n### Read and View Data {.tabset .tabset-fade .tabset-pills}\n\n::: blue\n**This code reads in and shows the data to be used in the current\nexample**\n\n```{r read-data}\n#| echo: TRUE\n#| messages: FALSE\n#| warning: FALSE\n#| output: FALSE\n#| cache: FALSE\n\n# Set the data paths\ndata_path_1 <- \"/Users/shawes/ABCD/data/rds/abcd_5.0_rds/demo5.0.rds\"\ndata_path_2 <- \"/Users/shawes/ABCD/data/rds/abcd_5.0_rds/core-rds-5.0/non-imaging_excluding_nt_5.0.rds\"\n\n# Read the data\ndata_demographics <- readRDS(data_path_1)\ndata_nonimaging <- readRDS(data_path_2)\n\n# Subset the nonimaging data to include desired variables\nselected_vars <- c(\"src_subject_id\", \"eventname\", \"nihtbx_totalcomp_fc\", \"anthroweightcalc\", \"anthroheightcalc\")\nsubset_data <- data_nonimaging[, selected_vars]\n\nlibrary(dplyr)\n# # Merge the datasets on 'src_subject_id' and 'eventname'\nmerged_data <- data_demographics %>%\n  full_join(subset_data, by = c(\"src_subject_id\", \"eventname\"))\n\n# Inspect the merged data structure\nstr(merged_data)\n\n# Define event names to be retained in the analysis and convert variables to appropriate data types\neventnames_to_include <- c(\"baseline_year_1_arm_1\",\n                           \"1_year_follow_up_y_arm_1\",\n                           \"2_year_follow_up_y_arm_1\",\n                           \"3_year_follow_up_y_arm_1\",\n                           \"4_year_follow_up_y_arm_1\")\n\ndf <- merged_data %>%\n  filter(eventname %in% eventnames_to_include) %>%\n  mutate(\n    src_subject_id = as.factor(src_subject_id),\n    eventname = factor(eventname, levels = eventnames_to_include, ordered = TRUE),\n    age = as.numeric(age),\n    sex = as.factor(sex),\n    race.4level = as.factor(race.4level),\n    hisp = as.factor(hisp),\n    high.educ.bl = as.factor(high.educ.bl),\n    household.income.bl = as.factor(household.income.bl),\n    acs_raked_propensity_score = as.numeric(acs_raked_propensity_score),\n    rel_family_id.bl = as.factor(rel_family_id.bl),\n    site_id_l = as.factor(site_id_l),\n    nihtbx_totalcomp_fc = as.numeric(nihtbx_totalcomp_fc),\n    anthroweightcalc = as.numeric(anthroweightcalc),\n    anthroheightcalc = as.numeric(anthroheightcalc)\n  ) %>%\n  # Exclude cases from unused assessment waves\n  filter(!is.na(eventname))\n\n```\n:::\n\n### Descriptives\n\n::: blue\n**This code creates a descriptives table**\n\n```{r descriptives}\n#| echo: TRUE\n#| messages: FALSE\n#| warning: FALSE\n\n# Define a function to compute descriptives\ncompute_descriptives <- function(data, event_name) {\n  # For factor variables\n  sex_desc <- paste0(table(data$sex), \" (\", round(100 * prop.table(table(data$sex)), 1), \"%)\")\n  race_desc <- paste0(table(data$race.4level), \" (\", round(100 * prop.table(table(data$race.4level)), 1), \"%)\")\n  \n  # For numeric variables\n  age_desc <- paste0(round(mean(data$age, na.rm = TRUE), 2), \" (\", round(sd(data$age, na.rm = TRUE), 2), \")\")\n  weight_desc <- paste0(round(mean(data$anthroweightcalc, na.rm = TRUE), 2), \" (\", round(sd(data$anthroweightcalc, na.rm = TRUE), 2), \")\")\n  height_desc <- paste0(round(mean(data$anthroheightcalc, na.rm = TRUE), 2), \" (\", round(sd(data$anthroheightcalc, na.rm = TRUE), 2), \")\")\n  \n  # Combine into a data frame\n  desc_df <- data.frame(\n    Variable = c(\"Sex - Female\", \"Sex - Male or other\", \"Race - Asian\", \"Race - Black\", \"Race - Other/Mixed\", \"Race - White\", \"Age\", \"Weight\", \"Height\"),\n    Value = c(sex_desc, race_desc, age_desc, weight_desc, height_desc)\n  )\n  \n  # Rename the Value column based on event name\n  colnames(desc_df)[2] <- event_name\n  return(desc_df)\n}\n\n# Compute descriptives for each event\nbaseline_desc <- compute_descriptives(subset(df, eventname == \"baseline_year_1_arm_1\"), \"baseline_year_1_arm_1\")\none_year_desc <- compute_descriptives(subset(df, eventname == \"1_year_follow_up_y_arm_1\"), \"1_year_follow_up_y_arm_1\")\ntwo_year_desc <- compute_descriptives(subset(df, eventname == \"2_year_follow_up_y_arm_1\"), \"2_year_follow_up_y_arm_1\")\nthree_year_desc <- compute_descriptives(subset(df, eventname == \"3_year_follow_up_y_arm_1\"), \"3_year_follow_up_y_arm_1\")\n\n# Join all data frames side-by-side\nfinal_table <- baseline_desc %>%\n  left_join(one_year_desc, by = \"Variable\") %>%\n  left_join(two_year_desc, by = \"Variable\") %>%\n  left_join(three_year_desc, by = \"Variable\")\n\n# Adjust for the required format\nfinal_table[1:6, 3:5] <- NA\n\n# Round numeric values to two decimal places\nnumeric_cols <- sapply(final_table, is.numeric)\nfinal_table[numeric_cols] <- lapply(final_table[numeric_cols], round, 2)\n\n# Create heading rows with the same columns as final_table\nheading_rows <- data.frame(\n  Variable = c(\"Sex\", \"Race\"),\n  baseline_year_1_arm_1 = NA_real_,\n  `1_year_follow_up_y_arm_1` = NA_real_,\n  `2_year_follow_up_y_arm_1` = NA_real_,\n  `3_year_follow_up_y_arm_1` = NA_real_\n)\n\n# Set column names of heading_rows to match final_table\ncolnames(heading_rows) <- colnames(final_table)\n\n# Introduce group labels and adjust the \"Variable\" column\nfinal_table <- rbind(\n                    heading_rows[1,], \n                    final_table[1:2,],\n                    heading_rows[2,], \n                    final_table[3:6,], \n                    final_table[7:9,]\n                    )\n\n# Update the Variable column to remove redundant factor variable name\nfinal_table$Variable <- gsub(\"Sex - \", \"\", final_table$Variable)\nfinal_table$Variable <- gsub(\"Race - \", \"\", final_table$Variable)\nfinal_table$Variable[final_table$Variable == \"Male or other\"] <- \"Male\"\n\n# Add non-breaking spaces for increased indentation\nfinal_table$Variable[final_table$Variable %in% c(\"Female\", \"Male\", \"Asian\", \"Black\", \"Other/Mixed\", \"White\")] <- \n  paste0(rep(\"&nbsp;\", 6), final_table$Variable[final_table$Variable %in% c(\"Female\", \"Male\", \"Asian\", \"Black\", \"Other/Mixed\", \"White\")])\n\n# Update column headers\ncolnames(final_table)[2:5] <- c(\"Baseline\", \"Year 1\", \"Year 2\", \"Year 3\")\n\n# Display the table interactively without row names, with updated column headers, and with HTML entities rendered\ndatatable(final_table, \n          colnames = c(\"\", \"Baseline\", \"Year 1\", \"Year 2\", \"Year 3\"),\n          options = list(pageLength = nrow(final_table), autoWidth = TRUE),\n          rownames = FALSE, escape = FALSE,\n          caption = \"Descriptives Table\")  # Add table title\n\n```\n\n:::\n:::\n\n## Results\n\n::: panel-tabset\n### Build Model {.tabset .tabset-fade .tabset-pills}\n\n::: blue\nThe code snippet below tells R to conduct a multiple regression analysis by subtracting each participant's height at T1 from their height at T0. Relevant summary statistics are also provided.\n\n**Compute Multiple Regression Model**\n```{r build-model-resid-regression-1}\n#| class.source: 'fold-hide'\n#| message: FALSE\n#| warning: FALSE\n#| echo: TRUE\n\n# Split data using the correct eventname values\nbaseline_data <- df %>% \n  filter(eventname == \"baseline_year_1_arm_1\") %>% \n  select(src_subject_id, Height_baseline = anthroheightcalc, Weight_baseline = anthroweightcalc)\n\nfollowup_data <- df %>% \n  filter(eventname == \"1_year_follow_up_y_arm_1\") %>% \n  select(src_subject_id, Height_followup = anthroheightcalc)\n\n# Merge baseline and follow-up data\nmerged_data <- baseline_data %>%\n  left_join(followup_data, by = \"src_subject_id\")\n\n# Check the first few rows of the merged data\n#head(merged_data)\n\n# Fit the regression model excluding NA values\nmodel <- lm(Height_followup ~ Height_baseline + Weight_baseline, data = merged_data, na.action = na.exclude)\n\n```\n\n:::\n\n### Model Summary {.tabset .tabset-fade .tabset-pills}\n\n::: blue\n\nA plot to show xxxxx.\n```{r model-checking}\nmodel_summary <- summary(model)\nprint(model_summary)\n\npar(mfrow = c(2, 2))  # Set up a 2x2 plotting area\nplot(model)  # Generate diagnostic plots\n\n```\n\nThis regression analysis evaluates how baseline height and weight predict children's height at a 1-year follow-up. The output from our model provides several key statistics:\n\ni. an F-statistic of `r model_summary$fstatistic[1]`;\nii. degrees of freedom of `r model_summary$df[2]`;\niii. parameter estimates for baseline height and weight;\niv. standard errors for these estimates; and\nv. p-values for the significance of these estimates.\n\nFor every one unit increase in baseline height, there's an associated increase of approximately `r round(model_summary$coefficients[\"Height_baseline\", \"Estimate\"], 3)` units in the follow-up height, and this effect was statistically significant with a p-value of `r model_summary$coefficients[\"Height_baseline\", \"Pr(>|t|)\"]`. Similarly, for every one unit increase in baseline weight, there's an associated increase of approximately `r round(model_summary$coefficients[\"Weight_baseline\", \"Estimate\"], 4)` units in the follow-up height, which is also statistically significant with a p-value of `r model_summary$coefficients[\"Weight_baseline\", \"Pr(>|t|)\"]`. Overall, this model explains a substantial portion of the variance in follow-up height, with an adjusted R-squared value of `r round(model_summary$adj.r.squared, 4)`. The overall model is highly significant with a p-value less than `r model_summary$coefficients[1,4]`, indicating that the predictors, collectively, have a significant relationship with the dependent variable.\n\n:::\n\n### Model Plots  {.tabset .tabset-fade .tabset-pills}\n\n::: blue\n```{r scatterplot}\n\n# Scatterplot with regression line for Weight_baseline\nggplot(merged_data, aes(x = Weight_baseline, y = Height_followup)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"lm\", color = \"black\") + \n  labs(title = \"Relationship between Baseline Weight and Follow-up Height\",\n       x = \"Baseline Weight\",\n       y = \"Follow-up Height\") +\n  theme_minimal()\n\n```\n\nThe scatterplot visually depicts the relationship between children's weights at baseline (`r names(merged_data)[3]`) and their heights at Year_1 (`r names(merged_data)[4]`). Each point on the plot represents a child, with their baseline weight plotted on the x-axis and their Year_1 height on the y-axis. The clear positive linear trend, as illustrated by the black regression line, indicates that children who had higher weights at baseline generally had higher heights at Year_1. While further statistical analyses can quantify the strength and direction of this relationship, visually, the data suggests a pronounced positive association between baseline weight and follow-up height.\n\n:::\n:::\n\n## Wrapping Up\n<div class = \"blue\">\n\n::: panel-tabset\n### Write-up {.tabset .tabset-fade .tabset-pills}\n\n::: blue\n\nThe regression analysis was conducted to predict children's height at the 1-Year follow-up using their baseline height (`r names(merged_data)[2]`) and weight (`r names(merged_data)[3]`). Both predictors were statistically significant. Specifically, for every one-unit increase in baseline height, the height at Year_1 increased by approximately `r round(model_summary$coefficients[\"Height_baseline\", \"Estimate\"], 3)` units, while holding weight constant. Similarly, for every one-unit increase in baseline weight, the height at Year_1 increased by about `r round(model_summary$coefficients[\"Weight_baseline\", \"Estimate\"], 4)` units, while holding baseline height constant. The overall model explained a substantial `r round(model_summary$adj.r.squared * 100, 2)`% of the variance in height at the 1-Year follow-up, as indicated by the adjusted R-squared value.\n  \n\n:::\n:::","srcMarkdownNoYaml":"\n\n# Mulitple Regression {.unnumbered}\n\n## Overview\n\n<p>\n\nThis example assesses whether height, measured at the 1-Year follow-up (T1) in a subsample of ABCD participants, is predicted by weight and height measured at baseline (T0). A visual inspection is further conducted via a scatterplot to graphically represent the relationship between height at Year_1 and weight at baseline, controlling for height at baseline. The ensuing analysis and interpretations are detailed in the subsequent sections.\n\n</p>\n\n## Preliminary Setup\n\n::: panel-tabset\n### Install Packages {.tabset .tabset-fade .tabset-pills}\n\n::: blue\n> **This code installs the r packages necessary for this example, if\n> they are not already installed**\n\n```{r pckg-install}\n#| echo: TRUE\n#| messages: FALSE\n#| warning: FALSE\n#| output: FALSE\n\n# Create a list of required packages\npackages_required <- c(\"tidyverse\",\"rstatix\",\"DT\",\"lme4\")\n\n# Check which packages are not installed and install them\npackages_to_install <- setdiff(packages_required, rownames(installed.packages()))\nif (length(packages_to_install) > 0) {\n    install.packages(packages_to_install)\n}\n\n# Load the required packages\nlapply(packages_required, library, character.only = TRUE)\n\n```\n:::\n\n### Load Packages\n\n::: blue\n**This code loads the r libraries necessary for this example**\n\n```{r lib-load}\n#| echo: TRUE\n#| messages: FALSE\n#| warning: FALSE\n#| output: FALSE\n\nlibrary(tidyverse)    # Collection of R packages for data science\nlibrary(rstatix)      # Pipe-friendly framework for basic statistical tests\nlibrary(DT)           # Rendering interactive data tables\nlibrary(lme4)         # Linear mixed-effects models\n\n```\n:::\n\n### Config Options\n\n::: blue\n**This code configures knitr code chunk options**\n\n```{r config}\n#| echo: TRUE\n#| messages: FALSE\n#| warning: FALSE\n#| output: FALSE\n\nknitr::opts_chunk$set(echo = T, message=F, warning=F, error=F, \n                      comment=NA, cache=T, code_folding=T,\n                      R.options=list(width=220, digits = 3),\n                      fig.align='center', \n                      out.width='75%', fig.asp=.75)\n```\n:::\n:::\n\n## Descriptives Overview\n\n::: panel-tabset\n### Read and View Data {.tabset .tabset-fade .tabset-pills}\n\n::: blue\n**This code reads in and shows the data to be used in the current\nexample**\n\n```{r read-data}\n#| echo: TRUE\n#| messages: FALSE\n#| warning: FALSE\n#| output: FALSE\n#| cache: FALSE\n\n# Set the data paths\ndata_path_1 <- \"/Users/shawes/ABCD/data/rds/abcd_5.0_rds/demo5.0.rds\"\ndata_path_2 <- \"/Users/shawes/ABCD/data/rds/abcd_5.0_rds/core-rds-5.0/non-imaging_excluding_nt_5.0.rds\"\n\n# Read the data\ndata_demographics <- readRDS(data_path_1)\ndata_nonimaging <- readRDS(data_path_2)\n\n# Subset the nonimaging data to include desired variables\nselected_vars <- c(\"src_subject_id\", \"eventname\", \"nihtbx_totalcomp_fc\", \"anthroweightcalc\", \"anthroheightcalc\")\nsubset_data <- data_nonimaging[, selected_vars]\n\nlibrary(dplyr)\n# # Merge the datasets on 'src_subject_id' and 'eventname'\nmerged_data <- data_demographics %>%\n  full_join(subset_data, by = c(\"src_subject_id\", \"eventname\"))\n\n# Inspect the merged data structure\nstr(merged_data)\n\n# Define event names to be retained in the analysis and convert variables to appropriate data types\neventnames_to_include <- c(\"baseline_year_1_arm_1\",\n                           \"1_year_follow_up_y_arm_1\",\n                           \"2_year_follow_up_y_arm_1\",\n                           \"3_year_follow_up_y_arm_1\",\n                           \"4_year_follow_up_y_arm_1\")\n\ndf <- merged_data %>%\n  filter(eventname %in% eventnames_to_include) %>%\n  mutate(\n    src_subject_id = as.factor(src_subject_id),\n    eventname = factor(eventname, levels = eventnames_to_include, ordered = TRUE),\n    age = as.numeric(age),\n    sex = as.factor(sex),\n    race.4level = as.factor(race.4level),\n    hisp = as.factor(hisp),\n    high.educ.bl = as.factor(high.educ.bl),\n    household.income.bl = as.factor(household.income.bl),\n    acs_raked_propensity_score = as.numeric(acs_raked_propensity_score),\n    rel_family_id.bl = as.factor(rel_family_id.bl),\n    site_id_l = as.factor(site_id_l),\n    nihtbx_totalcomp_fc = as.numeric(nihtbx_totalcomp_fc),\n    anthroweightcalc = as.numeric(anthroweightcalc),\n    anthroheightcalc = as.numeric(anthroheightcalc)\n  ) %>%\n  # Exclude cases from unused assessment waves\n  filter(!is.na(eventname))\n\n```\n:::\n\n### Descriptives\n\n::: blue\n**This code creates a descriptives table**\n\n```{r descriptives}\n#| echo: TRUE\n#| messages: FALSE\n#| warning: FALSE\n\n# Define a function to compute descriptives\ncompute_descriptives <- function(data, event_name) {\n  # For factor variables\n  sex_desc <- paste0(table(data$sex), \" (\", round(100 * prop.table(table(data$sex)), 1), \"%)\")\n  race_desc <- paste0(table(data$race.4level), \" (\", round(100 * prop.table(table(data$race.4level)), 1), \"%)\")\n  \n  # For numeric variables\n  age_desc <- paste0(round(mean(data$age, na.rm = TRUE), 2), \" (\", round(sd(data$age, na.rm = TRUE), 2), \")\")\n  weight_desc <- paste0(round(mean(data$anthroweightcalc, na.rm = TRUE), 2), \" (\", round(sd(data$anthroweightcalc, na.rm = TRUE), 2), \")\")\n  height_desc <- paste0(round(mean(data$anthroheightcalc, na.rm = TRUE), 2), \" (\", round(sd(data$anthroheightcalc, na.rm = TRUE), 2), \")\")\n  \n  # Combine into a data frame\n  desc_df <- data.frame(\n    Variable = c(\"Sex - Female\", \"Sex - Male or other\", \"Race - Asian\", \"Race - Black\", \"Race - Other/Mixed\", \"Race - White\", \"Age\", \"Weight\", \"Height\"),\n    Value = c(sex_desc, race_desc, age_desc, weight_desc, height_desc)\n  )\n  \n  # Rename the Value column based on event name\n  colnames(desc_df)[2] <- event_name\n  return(desc_df)\n}\n\n# Compute descriptives for each event\nbaseline_desc <- compute_descriptives(subset(df, eventname == \"baseline_year_1_arm_1\"), \"baseline_year_1_arm_1\")\none_year_desc <- compute_descriptives(subset(df, eventname == \"1_year_follow_up_y_arm_1\"), \"1_year_follow_up_y_arm_1\")\ntwo_year_desc <- compute_descriptives(subset(df, eventname == \"2_year_follow_up_y_arm_1\"), \"2_year_follow_up_y_arm_1\")\nthree_year_desc <- compute_descriptives(subset(df, eventname == \"3_year_follow_up_y_arm_1\"), \"3_year_follow_up_y_arm_1\")\n\n# Join all data frames side-by-side\nfinal_table <- baseline_desc %>%\n  left_join(one_year_desc, by = \"Variable\") %>%\n  left_join(two_year_desc, by = \"Variable\") %>%\n  left_join(three_year_desc, by = \"Variable\")\n\n# Adjust for the required format\nfinal_table[1:6, 3:5] <- NA\n\n# Round numeric values to two decimal places\nnumeric_cols <- sapply(final_table, is.numeric)\nfinal_table[numeric_cols] <- lapply(final_table[numeric_cols], round, 2)\n\n# Create heading rows with the same columns as final_table\nheading_rows <- data.frame(\n  Variable = c(\"Sex\", \"Race\"),\n  baseline_year_1_arm_1 = NA_real_,\n  `1_year_follow_up_y_arm_1` = NA_real_,\n  `2_year_follow_up_y_arm_1` = NA_real_,\n  `3_year_follow_up_y_arm_1` = NA_real_\n)\n\n# Set column names of heading_rows to match final_table\ncolnames(heading_rows) <- colnames(final_table)\n\n# Introduce group labels and adjust the \"Variable\" column\nfinal_table <- rbind(\n                    heading_rows[1,], \n                    final_table[1:2,],\n                    heading_rows[2,], \n                    final_table[3:6,], \n                    final_table[7:9,]\n                    )\n\n# Update the Variable column to remove redundant factor variable name\nfinal_table$Variable <- gsub(\"Sex - \", \"\", final_table$Variable)\nfinal_table$Variable <- gsub(\"Race - \", \"\", final_table$Variable)\nfinal_table$Variable[final_table$Variable == \"Male or other\"] <- \"Male\"\n\n# Add non-breaking spaces for increased indentation\nfinal_table$Variable[final_table$Variable %in% c(\"Female\", \"Male\", \"Asian\", \"Black\", \"Other/Mixed\", \"White\")] <- \n  paste0(rep(\"&nbsp;\", 6), final_table$Variable[final_table$Variable %in% c(\"Female\", \"Male\", \"Asian\", \"Black\", \"Other/Mixed\", \"White\")])\n\n# Update column headers\ncolnames(final_table)[2:5] <- c(\"Baseline\", \"Year 1\", \"Year 2\", \"Year 3\")\n\n# Display the table interactively without row names, with updated column headers, and with HTML entities rendered\ndatatable(final_table, \n          colnames = c(\"\", \"Baseline\", \"Year 1\", \"Year 2\", \"Year 3\"),\n          options = list(pageLength = nrow(final_table), autoWidth = TRUE),\n          rownames = FALSE, escape = FALSE,\n          caption = \"Descriptives Table\")  # Add table title\n\n```\n\n:::\n:::\n\n## Results\n\n::: panel-tabset\n### Build Model {.tabset .tabset-fade .tabset-pills}\n\n::: blue\nThe code snippet below tells R to conduct a multiple regression analysis by subtracting each participant's height at T1 from their height at T0. Relevant summary statistics are also provided.\n\n**Compute Multiple Regression Model**\n```{r build-model-resid-regression-1}\n#| class.source: 'fold-hide'\n#| message: FALSE\n#| warning: FALSE\n#| echo: TRUE\n\n# Split data using the correct eventname values\nbaseline_data <- df %>% \n  filter(eventname == \"baseline_year_1_arm_1\") %>% \n  select(src_subject_id, Height_baseline = anthroheightcalc, Weight_baseline = anthroweightcalc)\n\nfollowup_data <- df %>% \n  filter(eventname == \"1_year_follow_up_y_arm_1\") %>% \n  select(src_subject_id, Height_followup = anthroheightcalc)\n\n# Merge baseline and follow-up data\nmerged_data <- baseline_data %>%\n  left_join(followup_data, by = \"src_subject_id\")\n\n# Check the first few rows of the merged data\n#head(merged_data)\n\n# Fit the regression model excluding NA values\nmodel <- lm(Height_followup ~ Height_baseline + Weight_baseline, data = merged_data, na.action = na.exclude)\n\n```\n\n:::\n\n### Model Summary {.tabset .tabset-fade .tabset-pills}\n\n::: blue\n\nA plot to show xxxxx.\n```{r model-checking}\nmodel_summary <- summary(model)\nprint(model_summary)\n\npar(mfrow = c(2, 2))  # Set up a 2x2 plotting area\nplot(model)  # Generate diagnostic plots\n\n```\n\nThis regression analysis evaluates how baseline height and weight predict children's height at a 1-year follow-up. The output from our model provides several key statistics:\n\ni. an F-statistic of `r model_summary$fstatistic[1]`;\nii. degrees of freedom of `r model_summary$df[2]`;\niii. parameter estimates for baseline height and weight;\niv. standard errors for these estimates; and\nv. p-values for the significance of these estimates.\n\nFor every one unit increase in baseline height, there's an associated increase of approximately `r round(model_summary$coefficients[\"Height_baseline\", \"Estimate\"], 3)` units in the follow-up height, and this effect was statistically significant with a p-value of `r model_summary$coefficients[\"Height_baseline\", \"Pr(>|t|)\"]`. Similarly, for every one unit increase in baseline weight, there's an associated increase of approximately `r round(model_summary$coefficients[\"Weight_baseline\", \"Estimate\"], 4)` units in the follow-up height, which is also statistically significant with a p-value of `r model_summary$coefficients[\"Weight_baseline\", \"Pr(>|t|)\"]`. Overall, this model explains a substantial portion of the variance in follow-up height, with an adjusted R-squared value of `r round(model_summary$adj.r.squared, 4)`. The overall model is highly significant with a p-value less than `r model_summary$coefficients[1,4]`, indicating that the predictors, collectively, have a significant relationship with the dependent variable.\n\n:::\n\n### Model Plots  {.tabset .tabset-fade .tabset-pills}\n\n::: blue\n```{r scatterplot}\n\n# Scatterplot with regression line for Weight_baseline\nggplot(merged_data, aes(x = Weight_baseline, y = Height_followup)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"lm\", color = \"black\") + \n  labs(title = \"Relationship between Baseline Weight and Follow-up Height\",\n       x = \"Baseline Weight\",\n       y = \"Follow-up Height\") +\n  theme_minimal()\n\n```\n\nThe scatterplot visually depicts the relationship between children's weights at baseline (`r names(merged_data)[3]`) and their heights at Year_1 (`r names(merged_data)[4]`). Each point on the plot represents a child, with their baseline weight plotted on the x-axis and their Year_1 height on the y-axis. The clear positive linear trend, as illustrated by the black regression line, indicates that children who had higher weights at baseline generally had higher heights at Year_1. While further statistical analyses can quantify the strength and direction of this relationship, visually, the data suggests a pronounced positive association between baseline weight and follow-up height.\n\n:::\n:::\n\n## Wrapping Up\n<div class = \"blue\">\n\n::: panel-tabset\n### Write-up {.tabset .tabset-fade .tabset-pills}\n\n::: blue\n\nThe regression analysis was conducted to predict children's height at the 1-Year follow-up using their baseline height (`r names(merged_data)[2]`) and weight (`r names(merged_data)[3]`). Both predictors were statistically significant. Specifically, for every one-unit increase in baseline height, the height at Year_1 increased by approximately `r round(model_summary$coefficients[\"Height_baseline\", \"Estimate\"], 3)` units, while holding weight constant. Similarly, for every one-unit increase in baseline weight, the height at Year_1 increased by about `r round(model_summary$coefficients[\"Weight_baseline\", \"Estimate\"], 4)` units, while holding baseline height constant. The overall model explained a substantial `r round(model_summary$adj.r.squared * 100, 2)`% of the variance in height at the 1-Year follow-up, as indicated by the adjusted R-squared value.\n  \n\n:::\n:::"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"paged","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"message":false,"cold-folding":true,"R.options":"list(width=220)","fig.align":"center","out.width":"75%","fig.asp":0.75,"dev":"cairo_pdf","engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":true,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":true,"link-external-newwindow":true,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"toc-depth":1,"html-math-method":"katex","output-file":"2_Examples_ResidualizedChangeScores.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","bibliography":["references.bib"],"comments":{"hypothesis":true},"theme":"styles.scss","toc-expand":3,"toc-title":"Table of Contents","anchor-sections":true,"smooth-scroll":true,"linestretch":1.5,"code-copy":true,"code-summary":"Code","code-block-bg":true,"code-block-border-left":"#31BAE9","options":"max.print=75000","grid":{"sidebar-width":"425px"},"title":"Residualized Change Scores","author":"Biostatistics Working Group"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}
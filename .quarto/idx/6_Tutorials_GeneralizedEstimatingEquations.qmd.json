{"title":"Generalized Estimating Equations","markdown":{"yaml":{"title":"Generalized Estimating Equations","author":"Biostatistics Working Group"},"headingText":"Overview","containsRefs":false,"markdown":"\n\nGeneralized estimating equations (GEEs) are designed to analyze correlated data often encountered in longitudinal studies due to their ability to manage repeated measurements on the same subjects. Although similar to the general linear model (GLM), GEEs extend their capabilities by addressing correlations within clusters of data, such as measurements within the same individual. GEEs consist of a population-averaged approach, focusing on modeling the average response over individuals while accounting for within-subject correlations. Unlike models that emphasize subject-specific effects, GEEs provide insights into broader trends across the population (i.e., population-level patterns).\n\n### When to use Longitudinal Generalized Estimating Equations?\nYou should use generalized estimating equations in the following scenario:\n\n1. You want to know: How the average outcome of a population evolves over time, especially when dealing with correlated or clustered data.\n2. Your variable: Is measured repeatedly across various time points or settings, capturing the inherent correlations within subjects.\n3. You have: Repeated measurements on subjects that could be correlated, and you're interested in the population-averaged effects rather than subject-specific effects.\n\n### Getting Started with Longitudinal Generalized Estimating Equations (GEEs)\nIn this tutorial, we will introduce the concept of longitudinal generalized estimating equations (GEEs) and guide you through a simple example using a small dataset. By the end of this tutorial, you will be able to:\n\n1. Understand the basic principles of generalized estimating equations in longitudinal settings.\n2. Fit a GEE model using example data in R.\n3. Analyze and interpreting the results from the GEE analysis.\n\n## Basic Example\nIn this tutorial, we will begin by generating a sample dataset directly within R to ensure everyone has the same starting point and can follow along without needing to download or access external files. This generated dataset will serve as our example throughout this tutorial. In your own analyses, you'll likely start by importing your own data.\n\nThe simulated dataset created for this example consists of scores on a single outcome variable (\"Job_Satisfaction\") for 500 individuals each measured at four time points: T1-T4.\n\n#### Create Example Dataset\n```{r}\n\n# This will create a dataset with 2000 rows (4 rows for each of the 500 individuals).\n\n# Setting the number of individuals for our sample data\nn <- 500\n\n# Specifying the desired correlation matrix for our data\ncor_matrix <- matrix(c(1, 0.30, 0.30, 0.30, \n                      0.30, 1, 0.30, 0.30, \n                      0.30, 0.30, 1, 0.30,\n                      0.30, 0.30, 0.30, 1),\n                      nrow=4)\n\n# Using Cholesky decomposition to generate correlated data\ncholesky <- chol(cor_matrix)\n\n# Generating correlated random data for 4 timepoints\nrandom_data <- matrix(rnorm(n * 4), ncol=4)\ncorrelated_data <- random_data %*% cholesky\n\n# Convert the correlated data to probabilities using the plogis function\ncorrelated_probs <- plogis(correlated_data)\n\n# Convert the probabilities to binary outcomes (using 0.5 as the threshold)\nbinary_outcomes <- ifelse(correlated_probs > 0.5, 1, 0)\n\n# Converting the generated data into a structured data frame\ndata <- data.frame(\n  Individual = rep(1:n, each=4),\n  TimePoint = rep(c(\"T1\", \"T2\", \"T3\", \"T4\"), times=n),\n  Job_Satisfaction = as.vector(t(binary_outcomes))\n)\n\n```\n\n#### View Dataset\n```{r}\nhead(data)\n```\n\n### Model Specification and Estimation\nTo specify a Generalized Estimating Equation (GEE) model, we will utilize the `geepack` package in R. GEE models are designed to handle correlated data, making them suitable for longitudinal and other clustered data structures. In GEE, we focus on estimating the population-averaged effects of predictors while accounting for the within-cluster correlations using a specified working correlation structure.\n\n#### Install and Load Necessary Libraries\n```{r}\nif (!(\"geepack\" %in% installed.packages())) install.packages(\"geepack\")\nlibrary(geepack)\n```\n\n#### Model\n```{r}\n# Running the model\nmodel <- geeglm(Job_Satisfaction ~ TimePoint, data = data, id = Individual, family = binomial(link = \"logit\"), corstr = \"exchangeable\")\n\n```\n\n#### Model Summary\n```{r}\nprint(model)\n```\n\n\n```{r}\n## Creating variable (names) from output to be used for inline text\n\np_value_T2 <- summary(model)$coefficients[\"TimePointT2\", \"Pr(>|W|)\"]\np_value_T3 <- summary(model)$coefficients[\"TimePointT3\", \"Pr(>|W|)\"]\ncoeff_T3 <- summary(model)$coefficients[\"TimePointT3\", 3]\n\n```\n\n### Interpreting the Results\nGeneralized Estimating Equations (GEE) were used to model the relationship between Job Satisfaction and TimePoint, taking into account the correlation of repeated measures within individuals. The model assumes a binomial distribution for Job Satisfaction with a logit link function and uses an exchangeable correlation structure. The output of the `geeglm` function provides estimates for the coefficients, along with their standard errors, Wald statistics, and p-values. The coefficient for `TimePoint` represents the change in the log odds of Job Satisfaction for a unit change in TimePoint.\n\nFor a detailed understanding, we can refer to:\n- Coefficient (Estimate) for `TimePoint`: `r coeff_T3`\n- Associated p-value: `r p_value_T2`)\n\n## Conclusion\nIf the p-value for the `TimePoint` coefficient is less than 0.05, we can conclude that there is a statistically significant change in Job Satisfaction across the TimePoints according to the GEE model. Otherwise, we do not find evidence for such a change. The direction (increase or decrease) of this change can be determined by the sign of the coefficient for `TimePoint`.\n\n\n","srcMarkdownNoYaml":"\n\n## Overview\nGeneralized estimating equations (GEEs) are designed to analyze correlated data often encountered in longitudinal studies due to their ability to manage repeated measurements on the same subjects. Although similar to the general linear model (GLM), GEEs extend their capabilities by addressing correlations within clusters of data, such as measurements within the same individual. GEEs consist of a population-averaged approach, focusing on modeling the average response over individuals while accounting for within-subject correlations. Unlike models that emphasize subject-specific effects, GEEs provide insights into broader trends across the population (i.e., population-level patterns).\n\n### When to use Longitudinal Generalized Estimating Equations?\nYou should use generalized estimating equations in the following scenario:\n\n1. You want to know: How the average outcome of a population evolves over time, especially when dealing with correlated or clustered data.\n2. Your variable: Is measured repeatedly across various time points or settings, capturing the inherent correlations within subjects.\n3. You have: Repeated measurements on subjects that could be correlated, and you're interested in the population-averaged effects rather than subject-specific effects.\n\n### Getting Started with Longitudinal Generalized Estimating Equations (GEEs)\nIn this tutorial, we will introduce the concept of longitudinal generalized estimating equations (GEEs) and guide you through a simple example using a small dataset. By the end of this tutorial, you will be able to:\n\n1. Understand the basic principles of generalized estimating equations in longitudinal settings.\n2. Fit a GEE model using example data in R.\n3. Analyze and interpreting the results from the GEE analysis.\n\n## Basic Example\nIn this tutorial, we will begin by generating a sample dataset directly within R to ensure everyone has the same starting point and can follow along without needing to download or access external files. This generated dataset will serve as our example throughout this tutorial. In your own analyses, you'll likely start by importing your own data.\n\nThe simulated dataset created for this example consists of scores on a single outcome variable (\"Job_Satisfaction\") for 500 individuals each measured at four time points: T1-T4.\n\n#### Create Example Dataset\n```{r}\n\n# This will create a dataset with 2000 rows (4 rows for each of the 500 individuals).\n\n# Setting the number of individuals for our sample data\nn <- 500\n\n# Specifying the desired correlation matrix for our data\ncor_matrix <- matrix(c(1, 0.30, 0.30, 0.30, \n                      0.30, 1, 0.30, 0.30, \n                      0.30, 0.30, 1, 0.30,\n                      0.30, 0.30, 0.30, 1),\n                      nrow=4)\n\n# Using Cholesky decomposition to generate correlated data\ncholesky <- chol(cor_matrix)\n\n# Generating correlated random data for 4 timepoints\nrandom_data <- matrix(rnorm(n * 4), ncol=4)\ncorrelated_data <- random_data %*% cholesky\n\n# Convert the correlated data to probabilities using the plogis function\ncorrelated_probs <- plogis(correlated_data)\n\n# Convert the probabilities to binary outcomes (using 0.5 as the threshold)\nbinary_outcomes <- ifelse(correlated_probs > 0.5, 1, 0)\n\n# Converting the generated data into a structured data frame\ndata <- data.frame(\n  Individual = rep(1:n, each=4),\n  TimePoint = rep(c(\"T1\", \"T2\", \"T3\", \"T4\"), times=n),\n  Job_Satisfaction = as.vector(t(binary_outcomes))\n)\n\n```\n\n#### View Dataset\n```{r}\nhead(data)\n```\n\n### Model Specification and Estimation\nTo specify a Generalized Estimating Equation (GEE) model, we will utilize the `geepack` package in R. GEE models are designed to handle correlated data, making them suitable for longitudinal and other clustered data structures. In GEE, we focus on estimating the population-averaged effects of predictors while accounting for the within-cluster correlations using a specified working correlation structure.\n\n#### Install and Load Necessary Libraries\n```{r}\nif (!(\"geepack\" %in% installed.packages())) install.packages(\"geepack\")\nlibrary(geepack)\n```\n\n#### Model\n```{r}\n# Running the model\nmodel <- geeglm(Job_Satisfaction ~ TimePoint, data = data, id = Individual, family = binomial(link = \"logit\"), corstr = \"exchangeable\")\n\n```\n\n#### Model Summary\n```{r}\nprint(model)\n```\n\n\n```{r}\n## Creating variable (names) from output to be used for inline text\n\np_value_T2 <- summary(model)$coefficients[\"TimePointT2\", \"Pr(>|W|)\"]\np_value_T3 <- summary(model)$coefficients[\"TimePointT3\", \"Pr(>|W|)\"]\ncoeff_T3 <- summary(model)$coefficients[\"TimePointT3\", 3]\n\n```\n\n### Interpreting the Results\nGeneralized Estimating Equations (GEE) were used to model the relationship between Job Satisfaction and TimePoint, taking into account the correlation of repeated measures within individuals. The model assumes a binomial distribution for Job Satisfaction with a logit link function and uses an exchangeable correlation structure. The output of the `geeglm` function provides estimates for the coefficients, along with their standard errors, Wald statistics, and p-values. The coefficient for `TimePoint` represents the change in the log odds of Job Satisfaction for a unit change in TimePoint.\n\nFor a detailed understanding, we can refer to:\n- Coefficient (Estimate) for `TimePoint`: `r coeff_T3`\n- Associated p-value: `r p_value_T2`)\n\n## Conclusion\nIf the p-value for the `TimePoint` coefficient is less than 0.05, we can conclude that there is a statistically significant change in Job Satisfaction across the TimePoints according to the GEE model. Otherwise, we do not find evidence for such a change. The direction (increase or decrease) of this change can be determined by the sign of the coefficient for `TimePoint`.\n\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"paged","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"message":false,"cold-folding":true,"R.options":"list(width=220)","fig.align":"center","out.width":"75%","fig.asp":0.75,"dev":"cairo_pdf","engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":true,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":true,"link-external-newwindow":true,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"toc-depth":1,"html-math-method":"katex","output-file":"6_Tutorials_GeneralizedEstimatingEquations.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","bibliography":["references.bib"],"comments":{"hypothesis":true},"theme":"styles.scss","toc-expand":3,"toc-title":"Table of Contents","anchor-sections":true,"smooth-scroll":true,"linestretch":1.5,"code-copy":true,"code-summary":"Code","code-block-bg":true,"code-block-border-left":"#31BAE9","options":"max.print=75000","grid":{"sidebar-width":"425px"},"title":"Generalized Estimating Equations","author":"Biostatistics Working Group"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}
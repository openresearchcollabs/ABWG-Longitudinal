{"title":"Latent Growth Curve Models","markdown":{"yaml":{"title":"Latent Growth Curve Models","author":"Biostatistics Working Group"},"headingText":"Overview","containsRefs":false,"markdown":"\n\nLatent growth curve models (LGCMs) are an advanced statistical approach that allows researchers to explore the trajectory of growth, decline, or stability over time within individuals. LGCMs have become indispensable in disciplines such as psychology, public health, and developmental research, owing to their capability to model individual differences in change trajectories and capture the underlying structure of growth. These models are an enhancement of structural equation modeling, designed specifically for longitudinal data, where the essence of change across multiple time points is of interest. LGCMs offer a flexible framework that can model both the average trajectory in the population (fixed effects) and individual deviations from this average (random effects). By representing time as a latent construct, these models capture the nuances of individual change while accounting for measurement error. This combination of capturing overarching growth patterns while also emphasizing individual differences is the hallmark of the \"latent\" growth curve models, making them a vital tool for understanding longitudinal patterns.\n\n![Latent Growth Curve Model 1_Tutorial](./figures/lgcm.png)\n\n### When to use Latent Growth Curve Models?\nYou should consider latent growth curve models in the following situations:\n\n1. You aim to explore: The trajectory of change over time for an observed variable.\n2. Your data: Contains repeated measures taken at multiple time points.\n3. You seek to: Capture both the average growth pattern in the population and individual differences in that growth.\n\n### Getting Started with Latent Growth Curve Models\nIn this tutorial, we will guide you through an example of a latent growth curve model using a small dataset. By the time you complete this tutorial, you will be equipped to:\n\n1. Understand the basic principles of latent growth curve models.\n2. Implement these models on your own longitudinal data using appropriate statistical tools.\n3. Analyze and draw meaningful inferences from the latent growth curve model outputs.\n\n## Basic Example\nIn this tutorial, we will begin by generating a sample dataset directly within R to ensure everyone has the same starting point and can follow along without needing to download or access external files. This generated dataset will serve as our example throughout this tutorial. In your own analyses, you'll likely start by importing your own data.\n\nThe simulated dataset created for this example consists of scores on a single outcome variable (\"Job_Satisfaction\") for 500 individuals each measured at four time points: T1-T4.\n\n#### Create Example Dataset\n```{r}\n# Setting the seed for reproducibility\nset.seed(123)\n\n# Setting the number of individuals for our sample data\nn <- 500\n\n# Specifying the desired correlation matrix for our data\ncor_matrix <- matrix(c(1, 0.3, 0.3, 0.3, \n                      0.3, 1, 0.3, 0.3,\n                      0.3, 0.3, 1, 0.3,\n                      0.3, 0.3, 0.3, 1), \n                      nrow=4)\n\n# Using Cholesky decomposition to generate correlated data\ncholesky <- chol(cor_matrix)\n\n# Generating correlated random data\nrandom_data <- matrix(rnorm(n * 4), ncol=4)\ncorrelated_data <- random_data %*% cholesky\n\n# Converting the generated data into a structured data frame in wide format\ndata_wide <- data.frame(\n  Individual = 1:n,\n  Job_Satisfaction_T1 = round(runif(n, 5, 10)),\n  Job_Satisfaction_T2 = round(runif(n, 5, 10)),\n  Job_Satisfaction_T3 = round(runif(n, 5, 10)),\n  Job_Satisfaction_T4 = round(runif(n, 5, 10))\n)\n\n```\n\n### View Dataset\n```{r}\nhead(data_wide)\n```\n\n### Model Specification and Estimation\nTo specify a Latent Growth Curve Model (LGCM), we will leverage the lavaan syntax to delineate both the measurement model and the structural model. The LGCM allows us to capture the trajectory of an outcome variable across multiple time points. By doing so, we can understand the inherent growth patterns and the variability around this growth, offering insights into individual differences and their development over time.\n\n#### Install and Load Necessary Libraries\n```{r}\nif (!(\"lavaan\" %in% installed.packages())) {\n  install.packages(\"lavaan\")\n}\n\nlibrary(lavaan)\n\n```\n\n#### Model\n```{r}\n\n# Define the Latent Growth Curve Model\nmodel <- '\n  # Latent variables\n    i =~ 1 * Job_Satisfaction_T1 + 1 * Job_Satisfaction_T2 + 1 * Job_Satisfaction_T3 + 1 * Job_Satisfaction_T4\n    s =~ 0 * Job_Satisfaction_T1 + 1 * Job_Satisfaction_T2 + 2 * Job_Satisfaction_T3 + 3 * Job_Satisfaction_T4\n\n  # Variances\n    i ~~ var_i * i\n    s ~~ var_s * s\n\n  # Covariance\n    i ~~ cov_is * s\n'\n\n# Fit the model\nfit <- sem(model, data = data_wide)\n\n# Summary of the model\nsummary(fit, fit.measures=TRUE, standardized=TRUE, rsquare=TRUE)\n\n\n```\n\n#### Fit Model\n```{r}\n# Fit the model\nfit <- sem(model, data = data_wide, missing = \"FIML\")\n\n```\n\n#### Model Summary\n```{r}\nsummary(fit, fit.measures=TRUE, standardized=TRUE, rsquare=TRUE)\n```\n\n### Interpreting the Results\nA Latent Growth Curve Model (LGCM) was used to understand the trajectory of scores over time. This model separates the growth into two latent factors:\n- **Intercept (i)**: Represents the initial status or starting point.\n- **Slope (s)**: Represents the rate of change over time.\n\nFrom the `sem` output, we can interpret:\n- The average starting point (intercept) for the scores: **r round(fit@coef[\"mu_i\"], 3)**\n- The average rate of change (slope) for the scores: **r round(fit@coef[\"mu_s\"], 3)**\n\nThe variance in the intercept and slope, **r round(fit@coef[\"var_i\"], 3)** and **r round(fit@coef[\"var_s\"], 3)** respectively, gives us information on individual differences in the initial status and rate of change. Additionally, the covariance between the intercept and slope, **r round(fit@coef[\"cov_is\"], 3)**, informs us about the relationship between the initial status and the rate of change.\n\n## Conclusion\nThe LGCM provides a comprehensive understanding of the trajectory of scores over time. By examining the estimated intercept and slope, we can determine the general trend of scores across time points. Additionally, the variance and covariance parameters provide insights into individual differences in growth trajectories.\n\n\n\n","srcMarkdownNoYaml":"\n\n## Overview\nLatent growth curve models (LGCMs) are an advanced statistical approach that allows researchers to explore the trajectory of growth, decline, or stability over time within individuals. LGCMs have become indispensable in disciplines such as psychology, public health, and developmental research, owing to their capability to model individual differences in change trajectories and capture the underlying structure of growth. These models are an enhancement of structural equation modeling, designed specifically for longitudinal data, where the essence of change across multiple time points is of interest. LGCMs offer a flexible framework that can model both the average trajectory in the population (fixed effects) and individual deviations from this average (random effects). By representing time as a latent construct, these models capture the nuances of individual change while accounting for measurement error. This combination of capturing overarching growth patterns while also emphasizing individual differences is the hallmark of the \"latent\" growth curve models, making them a vital tool for understanding longitudinal patterns.\n\n![Latent Growth Curve Model 1_Tutorial](./figures/lgcm.png)\n\n### When to use Latent Growth Curve Models?\nYou should consider latent growth curve models in the following situations:\n\n1. You aim to explore: The trajectory of change over time for an observed variable.\n2. Your data: Contains repeated measures taken at multiple time points.\n3. You seek to: Capture both the average growth pattern in the population and individual differences in that growth.\n\n### Getting Started with Latent Growth Curve Models\nIn this tutorial, we will guide you through an example of a latent growth curve model using a small dataset. By the time you complete this tutorial, you will be equipped to:\n\n1. Understand the basic principles of latent growth curve models.\n2. Implement these models on your own longitudinal data using appropriate statistical tools.\n3. Analyze and draw meaningful inferences from the latent growth curve model outputs.\n\n## Basic Example\nIn this tutorial, we will begin by generating a sample dataset directly within R to ensure everyone has the same starting point and can follow along without needing to download or access external files. This generated dataset will serve as our example throughout this tutorial. In your own analyses, you'll likely start by importing your own data.\n\nThe simulated dataset created for this example consists of scores on a single outcome variable (\"Job_Satisfaction\") for 500 individuals each measured at four time points: T1-T4.\n\n#### Create Example Dataset\n```{r}\n# Setting the seed for reproducibility\nset.seed(123)\n\n# Setting the number of individuals for our sample data\nn <- 500\n\n# Specifying the desired correlation matrix for our data\ncor_matrix <- matrix(c(1, 0.3, 0.3, 0.3, \n                      0.3, 1, 0.3, 0.3,\n                      0.3, 0.3, 1, 0.3,\n                      0.3, 0.3, 0.3, 1), \n                      nrow=4)\n\n# Using Cholesky decomposition to generate correlated data\ncholesky <- chol(cor_matrix)\n\n# Generating correlated random data\nrandom_data <- matrix(rnorm(n * 4), ncol=4)\ncorrelated_data <- random_data %*% cholesky\n\n# Converting the generated data into a structured data frame in wide format\ndata_wide <- data.frame(\n  Individual = 1:n,\n  Job_Satisfaction_T1 = round(runif(n, 5, 10)),\n  Job_Satisfaction_T2 = round(runif(n, 5, 10)),\n  Job_Satisfaction_T3 = round(runif(n, 5, 10)),\n  Job_Satisfaction_T4 = round(runif(n, 5, 10))\n)\n\n```\n\n### View Dataset\n```{r}\nhead(data_wide)\n```\n\n### Model Specification and Estimation\nTo specify a Latent Growth Curve Model (LGCM), we will leverage the lavaan syntax to delineate both the measurement model and the structural model. The LGCM allows us to capture the trajectory of an outcome variable across multiple time points. By doing so, we can understand the inherent growth patterns and the variability around this growth, offering insights into individual differences and their development over time.\n\n#### Install and Load Necessary Libraries\n```{r}\nif (!(\"lavaan\" %in% installed.packages())) {\n  install.packages(\"lavaan\")\n}\n\nlibrary(lavaan)\n\n```\n\n#### Model\n```{r}\n\n# Define the Latent Growth Curve Model\nmodel <- '\n  # Latent variables\n    i =~ 1 * Job_Satisfaction_T1 + 1 * Job_Satisfaction_T2 + 1 * Job_Satisfaction_T3 + 1 * Job_Satisfaction_T4\n    s =~ 0 * Job_Satisfaction_T1 + 1 * Job_Satisfaction_T2 + 2 * Job_Satisfaction_T3 + 3 * Job_Satisfaction_T4\n\n  # Variances\n    i ~~ var_i * i\n    s ~~ var_s * s\n\n  # Covariance\n    i ~~ cov_is * s\n'\n\n# Fit the model\nfit <- sem(model, data = data_wide)\n\n# Summary of the model\nsummary(fit, fit.measures=TRUE, standardized=TRUE, rsquare=TRUE)\n\n\n```\n\n#### Fit Model\n```{r}\n# Fit the model\nfit <- sem(model, data = data_wide, missing = \"FIML\")\n\n```\n\n#### Model Summary\n```{r}\nsummary(fit, fit.measures=TRUE, standardized=TRUE, rsquare=TRUE)\n```\n\n### Interpreting the Results\nA Latent Growth Curve Model (LGCM) was used to understand the trajectory of scores over time. This model separates the growth into two latent factors:\n- **Intercept (i)**: Represents the initial status or starting point.\n- **Slope (s)**: Represents the rate of change over time.\n\nFrom the `sem` output, we can interpret:\n- The average starting point (intercept) for the scores: **r round(fit@coef[\"mu_i\"], 3)**\n- The average rate of change (slope) for the scores: **r round(fit@coef[\"mu_s\"], 3)**\n\nThe variance in the intercept and slope, **r round(fit@coef[\"var_i\"], 3)** and **r round(fit@coef[\"var_s\"], 3)** respectively, gives us information on individual differences in the initial status and rate of change. Additionally, the covariance between the intercept and slope, **r round(fit@coef[\"cov_is\"], 3)**, informs us about the relationship between the initial status and the rate of change.\n\n## Conclusion\nThe LGCM provides a comprehensive understanding of the trajectory of scores over time. By examining the estimated intercept and slope, we can determine the general trend of scores across time points. Additionally, the variance and covariance parameters provide insights into individual differences in growth trajectories.\n\n\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"paged","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"message":false,"cold-folding":true,"R.options":"list(width=220)","fig.align":"center","out.width":"75%","fig.asp":0.75,"dev":"cairo_pdf","engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":true,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":true,"link-external-newwindow":true,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"toc-depth":1,"html-math-method":"katex","output-file":"10_Tutorials_LatentGrowthCurveModels.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","bibliography":["references.bib"],"comments":{"hypothesis":true},"theme":{"light":"cosmos","dark":"darkly"},"toc-expand":3,"toc-title":"Table of Contents","anchor-sections":true,"smooth-scroll":true,"linestretch":1.5,"code-copy":true,"code-summary":"Code","code-block-bg":true,"code-block-border-left":"#31BAE9","options":"max.print=75000","grid":{"sidebar-width":"425px"},"title":"Latent Growth Curve Models","author":"Biostatistics Working Group"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}
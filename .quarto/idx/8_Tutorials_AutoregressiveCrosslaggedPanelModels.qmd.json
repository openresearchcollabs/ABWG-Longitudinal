{"title":"Autoregressive Crosslagged Panel Models","markdown":{"yaml":{"title":"Autoregressive Crosslagged Panel Models","author":"Biostatistics Working Group"},"headingText":"Overview","containsRefs":false,"markdown":"\n\nAutoregressive cross-lagged panel models (ARCL) are a statistical techniques used to examine dynamic and reciprocal associations between variables over time. ARCL models can provide insight into the bidirectional relationships between multiple variables over time. These models extend the concept of autoregressive models, which predict a variable based on its prior values, by also integrating cross-lagged effects, thereby capturing the influence of one variable on another in subsequent time points. This dual capability of capturing both autoregressive and cross-lagged effects makes ARCL models a common choice for researchers aiming to understand temporal and reciprocal associations in their data.\n\n![Autoregressive Crosslagged Panel 1_Tutorial](./figures/arcl.png)\n\n### When to use Autoregressive Crosslagged Panel Models?\nYou should consider autoregressive crosslagged panel (ARCL) models in the following situations:\n\n1. You want to understand: The reciprocal relationships between variables over time.\n2. Your variables: Are repeatedly measured across multiple time points.\n3. You aim to: Disentangle the directional relationship between these variables over successive time intervals.\n\n### Getting Started with Autoregressive Crosslagged Panel Models\nIn this tutorial, we will guide you through an example of an autoregressive crosslagged panel model using a small dataset. By the time you complete this tutorial, you will be equipped to:\n\n1. Understand the basic principles of autoregressive crosslagged panel models.\n2. Implement these models on longitudinal panel data using R.\n3. Analyze and interpet results from autoregressive crosslagged panel model analysis.\n\n## Basic Example\nIn this tutorial, we will begin by generating a sample dataset directly within R to ensure everyone has the same starting point and can follow along without needing to download or access external files. This generated dataset will serve as our example throughout this tutorial. In your own analyses, you'll likely start by importing your own data.\n\nThe simulated dataset created for this example consists of scores on a single outcome variable (\"Job_Satisfaction\") for 500 individuals each measured at four time points: T1-T4. \n\n- Subject ID\n- Time (in years)\n- Variable 1 (e.g., job satisfaction)\n\n#### Create Example Dataset\n```{r}\n# Setting the seed for reproducibility\nset.seed(123)\n\n# Setting the number of individuals for our sample data\nn <- 500\n\n# Specifying the desired correlation matrix for our data\ncor_matrix <- matrix(c(1, 0.3, 0.3, 0.3, \n                      0.3, 1, 0.3, 0.3,\n                      0.3, 0.3, 1, 0.3,\n                      0.3, 0.3, 0.3, 1), \n                      nrow=4)\n\n# Using Cholesky decomposition to generate correlated data\ncholesky <- chol(cor_matrix)\n\n# Generating correlated random data\nrandom_data <- matrix(rnorm(n * 4), ncol=4)\ncorrelated_data <- random_data %*% cholesky\n\n# Converting the generated data into a structured data frame in wide format\ndata <- data.frame(\n  Individual = 1:n,\n  Job_Satisfaction_T1 = round(runif(n, 5, 10)),\n  Job_Satisfaction_T2 = round(runif(n, 5, 10)),\n  Job_Satisfaction_T3 = round(runif(n, 5, 10)),\n  Job_Satisfaction_T4 = round(runif(n, 5, 10)),\n  Life_Satisfaction_T1 = round(correlated_data[,1] * 2 + 7),\n  Life_Satisfaction_T2 = round(correlated_data[,2] * 2 + 7),\n  Life_Satisfaction_T3 = round(correlated_data[,3] * 2 + 7),\n  Life_Satisfaction_T4 = round(correlated_data[,4] * 2 + 7)\n)\n\n```\n\n### View Dataset\n```{r}\nhead(data)\n```\n\n### Model Specification and Estimation\nTo specify an Autoregressive Crosslagged Panel Model (ARCL), we will utilize the lavaan syntax to focus on understanding the reciprocal influences between multiple variables over time. This approach allows us to discern how a change in one variable at a given time point can influence changes in another variable at subsequent time points, while also accounting for the autoregressive effects of each variable on itself across time.\n\n#### Install and Load Necessary Libraries\n```{r}\nif (!(\"lavaan\" %in% installed.packages())) install.packages(\"lavaan\")\nlibrary(lavaan)\n```\n\n#### Model\n```{r}\nmodel <- '\n  # Autoregressive paths\n  Job_Satisfaction_T2 ~ a1 * Job_Satisfaction_T1\n  Job_Satisfaction_T3 ~ a2 * Job_Satisfaction_T2\n  Job_Satisfaction_T4 ~ a3 * Job_Satisfaction_T3\n  \n  Life_Satisfaction_T2 ~ a4 * Life_Satisfaction_T1\n  Life_Satisfaction_T3 ~ a5 * Life_Satisfaction_T2\n  Life_Satisfaction_T4 ~ a6 * Life_Satisfaction_T3\n\n  # Cross-lagged paths\n  Job_Satisfaction_T2 ~ b1 * Life_Satisfaction_T1\n  Job_Satisfaction_T3 ~ b2 * Life_Satisfaction_T2\n  Job_Satisfaction_T4 ~ b3 * Life_Satisfaction_T3\n  \n  Life_Satisfaction_T2 ~ b4 * Job_Satisfaction_T1\n  Life_Satisfaction_T3 ~ b5 * Job_Satisfaction_T2\n  Life_Satisfaction_T4 ~ b6 * Job_Satisfaction_T3\n'\n\n```\n\n#### Fit Model\n```{r}\n# Fitting the model\nfit <- sem(model, data = data)\n                \n```\n\n#### Model Summary\n```{r}\n# Summarizing the model\nsummary(fit, fit.measures = TRUE, standardized = TRUE, rsquare = TRUE)\n\n```\n\n```{r}\n## Creating variable (names) from output to be used for inline text\n\nestimates <- parameterEstimates(fit)\nJob_Sat_T1 <- estimates[estimates$lhs == \"Job_Satisfaction_T1\", \"est\"]\nLife_Sat_T1 <- estimates[estimates$lhs == \"Life_Satisfaction_T1\", \"est\"]\n\nJobT2_to_LifeT1 <- estimates$est[estimates$label == \"b1\"]\nLifeT2_to_JobT1 <- estimates$est[estimates$label == \"a1\"]\n\n```\n\n### Interpreting the Results\nAn Autoregressive cross-lagged panel model (ARCL) was used to explore the reciprocal relationship between Job Satisfaction and Life Satisfaction across multiple time points. This model allows us to understand how past values of a variable can predict its future values and how one variable can influence the future values of another variable.\n\nFrom the `sem` output, we can interpret:\n- Autoregressive paths: How past values of Job Satisfaction and Life Satisfaction predict their future values.\n  - Coefficient for Job Satisfaction from T1 to T2: `r Job_Sat_T1`\n  - Coefficient for Life Satisfaction from T1 to T2: `r Life_Sat_T1`\n  (and so on for other time points)\n- Cross-lagged paths: How Job Satisfaction influences future values of Life Satisfaction and vice versa.\n  - Coefficient of Job Satisfaction at T1 influencing Life Satisfaction at T2: `r LifeT2_to_JobT1`\n  - Coefficient of Life Satisfaction at T1 influencing Job Satisfaction at T2: `r JobT2_to_LifeT1`\n  (and so on for other time points)\n\n\n\n\n## Conclusion\nThe ARCL model provides insights into the dynamic relationship between Job Satisfaction and Life Satisfaction. If the coefficients of the cross-lagged paths are significant, it suggests that there's a reciprocal influence between the two variables over time. The direction (positive or negative) and magnitude of these coefficients offer further understanding about the strength and nature of this relationship.\n\n","srcMarkdownNoYaml":"\n\n## Overview\nAutoregressive cross-lagged panel models (ARCL) are a statistical techniques used to examine dynamic and reciprocal associations between variables over time. ARCL models can provide insight into the bidirectional relationships between multiple variables over time. These models extend the concept of autoregressive models, which predict a variable based on its prior values, by also integrating cross-lagged effects, thereby capturing the influence of one variable on another in subsequent time points. This dual capability of capturing both autoregressive and cross-lagged effects makes ARCL models a common choice for researchers aiming to understand temporal and reciprocal associations in their data.\n\n![Autoregressive Crosslagged Panel 1_Tutorial](./figures/arcl.png)\n\n### When to use Autoregressive Crosslagged Panel Models?\nYou should consider autoregressive crosslagged panel (ARCL) models in the following situations:\n\n1. You want to understand: The reciprocal relationships between variables over time.\n2. Your variables: Are repeatedly measured across multiple time points.\n3. You aim to: Disentangle the directional relationship between these variables over successive time intervals.\n\n### Getting Started with Autoregressive Crosslagged Panel Models\nIn this tutorial, we will guide you through an example of an autoregressive crosslagged panel model using a small dataset. By the time you complete this tutorial, you will be equipped to:\n\n1. Understand the basic principles of autoregressive crosslagged panel models.\n2. Implement these models on longitudinal panel data using R.\n3. Analyze and interpet results from autoregressive crosslagged panel model analysis.\n\n## Basic Example\nIn this tutorial, we will begin by generating a sample dataset directly within R to ensure everyone has the same starting point and can follow along without needing to download or access external files. This generated dataset will serve as our example throughout this tutorial. In your own analyses, you'll likely start by importing your own data.\n\nThe simulated dataset created for this example consists of scores on a single outcome variable (\"Job_Satisfaction\") for 500 individuals each measured at four time points: T1-T4. \n\n- Subject ID\n- Time (in years)\n- Variable 1 (e.g., job satisfaction)\n\n#### Create Example Dataset\n```{r}\n# Setting the seed for reproducibility\nset.seed(123)\n\n# Setting the number of individuals for our sample data\nn <- 500\n\n# Specifying the desired correlation matrix for our data\ncor_matrix <- matrix(c(1, 0.3, 0.3, 0.3, \n                      0.3, 1, 0.3, 0.3,\n                      0.3, 0.3, 1, 0.3,\n                      0.3, 0.3, 0.3, 1), \n                      nrow=4)\n\n# Using Cholesky decomposition to generate correlated data\ncholesky <- chol(cor_matrix)\n\n# Generating correlated random data\nrandom_data <- matrix(rnorm(n * 4), ncol=4)\ncorrelated_data <- random_data %*% cholesky\n\n# Converting the generated data into a structured data frame in wide format\ndata <- data.frame(\n  Individual = 1:n,\n  Job_Satisfaction_T1 = round(runif(n, 5, 10)),\n  Job_Satisfaction_T2 = round(runif(n, 5, 10)),\n  Job_Satisfaction_T3 = round(runif(n, 5, 10)),\n  Job_Satisfaction_T4 = round(runif(n, 5, 10)),\n  Life_Satisfaction_T1 = round(correlated_data[,1] * 2 + 7),\n  Life_Satisfaction_T2 = round(correlated_data[,2] * 2 + 7),\n  Life_Satisfaction_T3 = round(correlated_data[,3] * 2 + 7),\n  Life_Satisfaction_T4 = round(correlated_data[,4] * 2 + 7)\n)\n\n```\n\n### View Dataset\n```{r}\nhead(data)\n```\n\n### Model Specification and Estimation\nTo specify an Autoregressive Crosslagged Panel Model (ARCL), we will utilize the lavaan syntax to focus on understanding the reciprocal influences between multiple variables over time. This approach allows us to discern how a change in one variable at a given time point can influence changes in another variable at subsequent time points, while also accounting for the autoregressive effects of each variable on itself across time.\n\n#### Install and Load Necessary Libraries\n```{r}\nif (!(\"lavaan\" %in% installed.packages())) install.packages(\"lavaan\")\nlibrary(lavaan)\n```\n\n#### Model\n```{r}\nmodel <- '\n  # Autoregressive paths\n  Job_Satisfaction_T2 ~ a1 * Job_Satisfaction_T1\n  Job_Satisfaction_T3 ~ a2 * Job_Satisfaction_T2\n  Job_Satisfaction_T4 ~ a3 * Job_Satisfaction_T3\n  \n  Life_Satisfaction_T2 ~ a4 * Life_Satisfaction_T1\n  Life_Satisfaction_T3 ~ a5 * Life_Satisfaction_T2\n  Life_Satisfaction_T4 ~ a6 * Life_Satisfaction_T3\n\n  # Cross-lagged paths\n  Job_Satisfaction_T2 ~ b1 * Life_Satisfaction_T1\n  Job_Satisfaction_T3 ~ b2 * Life_Satisfaction_T2\n  Job_Satisfaction_T4 ~ b3 * Life_Satisfaction_T3\n  \n  Life_Satisfaction_T2 ~ b4 * Job_Satisfaction_T1\n  Life_Satisfaction_T3 ~ b5 * Job_Satisfaction_T2\n  Life_Satisfaction_T4 ~ b6 * Job_Satisfaction_T3\n'\n\n```\n\n#### Fit Model\n```{r}\n# Fitting the model\nfit <- sem(model, data = data)\n                \n```\n\n#### Model Summary\n```{r}\n# Summarizing the model\nsummary(fit, fit.measures = TRUE, standardized = TRUE, rsquare = TRUE)\n\n```\n\n```{r}\n## Creating variable (names) from output to be used for inline text\n\nestimates <- parameterEstimates(fit)\nJob_Sat_T1 <- estimates[estimates$lhs == \"Job_Satisfaction_T1\", \"est\"]\nLife_Sat_T1 <- estimates[estimates$lhs == \"Life_Satisfaction_T1\", \"est\"]\n\nJobT2_to_LifeT1 <- estimates$est[estimates$label == \"b1\"]\nLifeT2_to_JobT1 <- estimates$est[estimates$label == \"a1\"]\n\n```\n\n### Interpreting the Results\nAn Autoregressive cross-lagged panel model (ARCL) was used to explore the reciprocal relationship between Job Satisfaction and Life Satisfaction across multiple time points. This model allows us to understand how past values of a variable can predict its future values and how one variable can influence the future values of another variable.\n\nFrom the `sem` output, we can interpret:\n- Autoregressive paths: How past values of Job Satisfaction and Life Satisfaction predict their future values.\n  - Coefficient for Job Satisfaction from T1 to T2: `r Job_Sat_T1`\n  - Coefficient for Life Satisfaction from T1 to T2: `r Life_Sat_T1`\n  (and so on for other time points)\n- Cross-lagged paths: How Job Satisfaction influences future values of Life Satisfaction and vice versa.\n  - Coefficient of Job Satisfaction at T1 influencing Life Satisfaction at T2: `r LifeT2_to_JobT1`\n  - Coefficient of Life Satisfaction at T1 influencing Job Satisfaction at T2: `r JobT2_to_LifeT1`\n  (and so on for other time points)\n\n\n\n\n## Conclusion\nThe ARCL model provides insights into the dynamic relationship between Job Satisfaction and Life Satisfaction. If the coefficients of the cross-lagged paths are significant, it suggests that there's a reciprocal influence between the two variables over time. The direction (positive or negative) and magnitude of these coefficients offer further understanding about the strength and nature of this relationship.\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"paged","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"message":false,"cold-folding":true,"R.options":"list(width=220)","fig.align":"center","out.width":"75%","fig.asp":0.75,"dev":"cairo_pdf","engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":true,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":true,"link-external-newwindow":true,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"toc-depth":1,"html-math-method":"katex","output-file":"8_Tutorials_AutoregressiveCrosslaggedPanelModels.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","bibliography":["references.bib"],"comments":{"hypothesis":true},"theme":"styles.scss","toc-expand":3,"toc-title":"Table of Contents","anchor-sections":true,"smooth-scroll":true,"linestretch":1.5,"code-copy":true,"code-summary":"Code","code-block-bg":true,"code-block-border-left":"#31BAE9","options":"max.print=75000","grid":{"sidebar-width":"425px"},"title":"Autoregressive Crosslagged Panel Models","author":"Biostatistics Working Group"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}
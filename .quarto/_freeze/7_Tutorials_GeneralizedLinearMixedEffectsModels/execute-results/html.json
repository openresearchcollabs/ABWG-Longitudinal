{
  "hash": "3ddbb7e0333b379339f7b609f1680cc9",
  "result": {
    "markdown": "---\ntitle: \"Generalized Linear Mixed Effects Models\"\nauthor: \"Biostatistics Working Group\"\n---\n\n\n## Overview\nGeneralized linear mixed-effects models (GLMMs) are a statistical methodology used to model both fixed effects and random variability. These models accommodate non-normal data and hierarchical or nested data structures. They extend the general linear model (GLM) to a mixed-effects framework which includes both fixed effects, which capture population-level trends, and random effects, which account for individual or group-specific variability. This particularly valuable for longitudinal studies where there is a need to capture both overarching trends and individual-specific trajectories. The mixed model approach allows for accomodating diverse data distributions while simultaneously capturing both the grand mean trend (fixed effect) and deviations specific to individual or groups (random effects). \n\n[+add diagrams/figures]\n\n### When to use Longitudinal Generalized Linear Mixed Effects Models?\nYou should employ longitudinal generalized linear mixed effects models in the following scenarios:\n\n1. You want to know: How individual trajectories change over time while accounting for within-subject correlations.\n2. Your variable: Is recorded over multiple time points and may not necessarily follow a normal distribution.\n3. You have: Longitudinal data where measurements within subjects are correlated and you want to capture both fixed (population-level) and random (subject-specific) effects in your analysis.\n\n### Getting Started with Longitudinal Generalized Linear Mixed Effects Models\nIn this tutorial, we will introduce the concept of longitudinal generalized linear mixed effects models (GLMMs) and guide you through a simple example using a small dataset. By the end of this tutorial, you will be able to:\n\n1. Understand the basic principles of GLMMs in longitudinal settings.\n2. Fit GLMMs to longitudinal data in R.\n3. Analyze and interpret results derived from GLMM analysis.\n\n## Basic Example\nIn this tutorial, we will begin by generating a sample dataset directly within R to ensure everyone has the same starting point and can follow along without needing to download or access external files. This generated dataset will serve as our example throughout this tutorial. In your own analyses, you'll likely start by importing your own data.\n\nThe simulated dataset created for this example consists of scores on a single outcome variable (\"Job_Satisfaction\") for 500 individuals each measured at four time points: T1-T4. \n\n#### Create Example Dataset\n\n::: {.cell hash='7_Tutorials_GeneralizedLinearMixedEffectsModels_cache/html/unnamed-chunk-1_797c2a91114980e8737a4f542594bceb'}\n\n```{.r .cell-code}\n# This will create a dataset with 2000 rows (4 rows for each of the 500 individuals).\n\n# Setting the number of individuals for our sample data\nn <- 500\n\n# Specifying the desired correlation matrix for our data\ncor_matrix <- matrix(c(1, 0.30, 0.30, 0.30, \n                      0.30, 1, 0.30, 0.30, \n                      0.30, 0.30, 1, 0.30,\n                      0.30, 0.30, 0.30, 1),\n                      nrow=4)\n\n# Using Cholesky decomposition to generate correlated data\ncholesky <- chol(cor_matrix)\n\n# Generating correlated random data for 4 timepoints\nrandom_data <- matrix(rnorm(n * 4), ncol=4)\ncorrelated_data <- random_data %*% cholesky\n\n# Convert the correlated data to probabilities using the plogis function\ncorrelated_probs <- plogis(correlated_data)\n\n# Convert the probabilities to binary outcomes (using 0.5 as the threshold)\nbinary_outcomes <- ifelse(correlated_probs > 0.5, 1, 0)\n\n# Converting the generated data into a structured data frame\ndata <- data.frame(\n  Individual = rep(1:n, each=4),\n  TimePoint = rep(c(\"T1\", \"T2\", \"T3\", \"T4\"), times=n),\n  Job_Satisfaction = as.vector(t(binary_outcomes))\n)\n```\n:::\n\n\n### View Dataset\n\n::: {.cell hash='7_Tutorials_GeneralizedLinearMixedEffectsModels_cache/html/unnamed-chunk-2_7533a705152d7ce20eb2960241f173f1'}\n\n```{.r .cell-code}\nhead(data)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Individual\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"TimePoint\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Job_Satisfaction\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"T1\",\"3\":\"1\",\"_rn_\":\"1\"},{\"1\":\"1\",\"2\":\"T2\",\"3\":\"0\",\"_rn_\":\"2\"},{\"1\":\"1\",\"2\":\"T3\",\"3\":\"1\",\"_rn_\":\"3\"},{\"1\":\"1\",\"2\":\"T4\",\"3\":\"1\",\"_rn_\":\"4\"},{\"1\":\"2\",\"2\":\"T1\",\"3\":\"1\",\"_rn_\":\"5\"},{\"1\":\"2\",\"2\":\"T2\",\"3\":\"1\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n### Model Specification and Estimation\nTo specify a Generalized Linear Mixed Effects Model (GLMM), we will use the `lme4` package in R to establish both the fixed and random effects in our model, accounting for the nested or hierarchical structure of the data by introducing random effects. This approach allows us to model non-normally distributed outcome variables, while capturing both fixed and random effects.\n\n#### Install and Load Necessary Libraries\n\n::: {.cell hash='7_Tutorials_GeneralizedLinearMixedEffectsModels_cache/html/unnamed-chunk-3_de2e21e64af6d7ce3b5d8afb5ca66027'}\n\n```{.r .cell-code}\nif (!(\"lme4\" %in% installed.packages())) install.packages(\"lme4\")\nlibrary(lme4)\n```\n:::\n\n\n#### Model\n\n::: {.cell hash='7_Tutorials_GeneralizedLinearMixedEffectsModels_cache/html/unnamed-chunk-4_733ef7a9479496978fb7090d545c9ce5'}\n\n```{.r .cell-code}\nmodel <- glmer(Job_Satisfaction ~ TimePoint + (1 | Individual), data = data, family = binomial(link = \"logit\"))\n```\n:::\n\n\n#### Model Summary\n\n::: {.cell hash='7_Tutorials_GeneralizedLinearMixedEffectsModels_cache/html/unnamed-chunk-5_2b11e5887aa5a823c11b1995c550460d'}\n\n```{.r .cell-code}\nprint(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nGeneralized linear mixed model fit by maximum likelihood (Laplace\n  Approximation) [glmerMod]\n Family: binomial  ( logit )\nFormula: Job_Satisfaction ~ TimePoint + (1 | Individual)\n   Data: data_large\n      AIC       BIC    logLik  deviance  df.resid \n 2708.245  2736.249 -1349.122  2698.245      1995 \nRandom effects:\n Groups     Name        Std.Dev.\n Individual (Intercept) 0.9539  \nNumber of obs: 2000, groups:  Individual, 500\nFixed Effects:\n(Intercept)  TimePointT2  TimePointT3  TimePointT4  \n  -0.019309    -0.106919     0.068009     0.009717  \n```\n:::\n:::\n\n::: {.cell hash='7_Tutorials_GeneralizedLinearMixedEffectsModels_cache/html/unnamed-chunk-6_691ee073be3a303bc793c40fd766e8d9'}\n\n```{.r .cell-code}\n## Creating variable (names) from output to be used for inline text\n\np_value_T2 <- summary(model)$coefficients[\"TimePointT2\", \"Pr(>|z|)\"]\np_value_T3 <- summary(model)$coefficients[\"TimePointT3\", \"Pr(>|z|)\"]\ncoeff_T3 <- summary(model)$coefficients[\"TimePointT3\", 3]\n```\n:::\n\n\n### Interpreting the Results\nA Generalized linear mixed-effects model (GLMM) was employed to understand the relationship between Job Satisfaction and TimePoint while accounting for the random effects associated with individuals. The model assumes a binomial distribution for Job Satisfaction with a logit link function.\n\nFrom the `glmer` output, we can gather key information:\n- Fixed effects coefficients, which give us information about the change in the log odds of Job Satisfaction for a unit change in TimePoint.\n- Random effects variance components, which quantify the variability in intercepts across individuals.\n\nFor a comprehensive interpretation, we would look at:\n- Coefficient (Estimate) for `TimePoint`: 0.284213\n- Associated p-value: 0.7762982)\n\n## Conclusion\nIf the p-value for the `TimePoint` coefficient is less than 0.05, we can conclude that there's a statistically significant change in Job Satisfaction across the TimePoints according to the GLMM. Otherwise, there isn't sufficient evidence to support such a change. The direction (increase or decrease) of this change is indicated by the sign of the coefficient for `TimePoint`.\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
{
  "hash": "e8c9c7e82a8197ea8b2a8dcea2e7f10f",
  "result": {
    "markdown": "---\ntitle: \"Autoregressive Crosslagged Panel Models\"\nauthor: \"Biostatistics Working Group\"\n---\n\n\n## Overview\nAutoregressive cross-lagged panel models (ARCL) are a statistical techniques used to examine dynamic and reciprocal associations between variables over time. ARCL models can provide insight into the bidirectional relationships between multiple variables over time. These models extend the concept of autoregressive models, which predict a variable based on its prior values, by also integrating cross-lagged effects, thereby capturing the influence of one variable on another in subsequent time points. This dual capability of capturing both autoregressive and cross-lagged effects makes ARCL models a common choice for researchers aiming to understand temporal and reciprocal associations in their data.\n\n![Autoregressive Crosslagged Panel 1_Tutorial](./figures/arcl.png)\n\n### When to use Autoregressive Crosslagged Panel Models?\nYou should consider autoregressive crosslagged panel (ARCL) models in the following situations:\n\n1. You want to understand: The reciprocal relationships between variables over time.\n2. Your variables: Are repeatedly measured across multiple time points.\n3. You aim to: Disentangle the directional relationship between these variables over successive time intervals.\n\n### Getting Started with Autoregressive Crosslagged Panel Models\nIn this tutorial, we will guide you through an example of an autoregressive crosslagged panel model using a small dataset. By the time you complete this tutorial, you will be equipped to:\n\n1. Understand the basic principles of autoregressive crosslagged panel models.\n2. Implement these models on longitudinal panel data using R.\n3. Analyze and interpet results from autoregressive crosslagged panel model analysis.\n\n## Basic Example\nIn this tutorial, we will begin by generating a sample dataset directly within R to ensure everyone has the same starting point and can follow along without needing to download or access external files. This generated dataset will serve as our example throughout this tutorial. In your own analyses, you'll likely start by importing your own data.\n\nThe simulated dataset created for this example consists of scores on a single outcome variable (\"Job_Satisfaction\") for 500 individuals each measured at four time points: T1-T4. \n\n- Subject ID\n- Time (in years)\n- Variable 1 (e.g., job satisfaction)\n\n#### Create Example Dataset\n\n::: {.cell hash='8_Tutorials_AutoregressiveCrosslaggedPanelModels_cache/html/unnamed-chunk-1_8c1933c72aaac8d778b7e47c27bf90a8'}\n\n```{.r .cell-code}\n# Setting the seed for reproducibility\nset.seed(123)\n\n# Setting the number of individuals for our sample data\nn <- 500\n\n# Specifying the desired correlation matrix for our data\ncor_matrix <- matrix(c(1, 0.3, 0.3, 0.3, \n                      0.3, 1, 0.3, 0.3,\n                      0.3, 0.3, 1, 0.3,\n                      0.3, 0.3, 0.3, 1), \n                      nrow=4)\n\n# Using Cholesky decomposition to generate correlated data\ncholesky <- chol(cor_matrix)\n\n# Generating correlated random data\nrandom_data <- matrix(rnorm(n * 4), ncol=4)\ncorrelated_data <- random_data %*% cholesky\n\n# Converting the generated data into a structured data frame in wide format\ndata <- data.frame(\n  Individual = 1:n,\n  Job_Satisfaction_T1 = round(runif(n, 5, 10)),\n  Job_Satisfaction_T2 = round(runif(n, 5, 10)),\n  Job_Satisfaction_T3 = round(runif(n, 5, 10)),\n  Job_Satisfaction_T4 = round(runif(n, 5, 10)),\n  Life_Satisfaction_T1 = round(correlated_data[,1] * 2 + 7),\n  Life_Satisfaction_T2 = round(correlated_data[,2] * 2 + 7),\n  Life_Satisfaction_T3 = round(correlated_data[,3] * 2 + 7),\n  Life_Satisfaction_T4 = round(correlated_data[,4] * 2 + 7)\n)\n```\n:::\n\n\n### View Dataset\n\n::: {.cell hash='8_Tutorials_AutoregressiveCrosslaggedPanelModels_cache/html/unnamed-chunk-2_7a07926a1cb03a6e514d6d20c523fe9c'}\n\n```{.r .cell-code}\nhead(data)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Individual\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Job_Satisfaction_T1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Job_Satisfaction_T2\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Job_Satisfaction_T3\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Job_Satisfaction_T4\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Life_Satisfaction_T1\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Life_Satisfaction_T2\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Life_Satisfaction_T3\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Life_Satisfaction_T4\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"7\",\"3\":\"6\",\"4\":\"6\",\"5\":\"6\",\"6\":\"6\",\"7\":\"6\",\"8\":\"5\",\"9\":\"5\",\"_rn_\":\"1\"},{\"1\":\"2\",\"2\":\"9\",\"3\":\"7\",\"4\":\"10\",\"5\":\"7\",\"6\":\"7\",\"7\":\"5\",\"8\":\"4\",\"9\":\"6\",\"_rn_\":\"2\"},{\"1\":\"3\",\"2\":\"8\",\"3\":\"7\",\"4\":\"9\",\"5\":\"6\",\"6\":\"10\",\"7\":\"10\",\"8\":\"8\",\"9\":\"7\",\"_rn_\":\"3\"},{\"1\":\"4\",\"2\":\"9\",\"3\":\"8\",\"4\":\"8\",\"5\":\"6\",\"6\":\"7\",\"7\":\"8\",\"8\":\"7\",\"9\":\"8\",\"_rn_\":\"4\"},{\"1\":\"5\",\"2\":\"6\",\"3\":\"5\",\"4\":\"6\",\"5\":\"9\",\"6\":\"7\",\"7\":\"4\",\"8\":\"2\",\"9\":\"8\",\"_rn_\":\"5\"},{\"1\":\"6\",\"2\":\"6\",\"3\":\"7\",\"4\":\"5\",\"5\":\"8\",\"6\":\"10\",\"7\":\"8\",\"8\":\"10\",\"9\":\"12\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n### Model Specification and Estimation\nTo specify an Autoregressive Crosslagged Panel Model (ARCL), we will utilize the lavaan syntax to focus on understanding the reciprocal influences between multiple variables over time. This approach allows us to discern how a change in one variable at a given time point can influence changes in another variable at subsequent time points, while also accounting for the autoregressive effects of each variable on itself across time.\n\n#### Install and Load Necessary Libraries\n\n::: {.cell hash='8_Tutorials_AutoregressiveCrosslaggedPanelModels_cache/html/unnamed-chunk-3_510714efd00b0aaf7883551c4a7cb0d2'}\n\n```{.r .cell-code}\nif (!(\"lavaan\" %in% installed.packages())) install.packages(\"lavaan\")\nlibrary(lavaan)\n```\n:::\n\n\n#### Model\n\n::: {.cell hash='8_Tutorials_AutoregressiveCrosslaggedPanelModels_cache/html/unnamed-chunk-4_af248c935c5180a06c857e89512b7366'}\n\n```{.r .cell-code}\nmodel <- '\n  # Autoregressive paths\n  Job_Satisfaction_T2 ~ a1 * Job_Satisfaction_T1\n  Job_Satisfaction_T3 ~ a2 * Job_Satisfaction_T2\n  Job_Satisfaction_T4 ~ a3 * Job_Satisfaction_T3\n  \n  Life_Satisfaction_T2 ~ a4 * Life_Satisfaction_T1\n  Life_Satisfaction_T3 ~ a5 * Life_Satisfaction_T2\n  Life_Satisfaction_T4 ~ a6 * Life_Satisfaction_T3\n\n  # Cross-lagged paths\n  Job_Satisfaction_T2 ~ b1 * Life_Satisfaction_T1\n  Job_Satisfaction_T3 ~ b2 * Life_Satisfaction_T2\n  Job_Satisfaction_T4 ~ b3 * Life_Satisfaction_T3\n  \n  Life_Satisfaction_T2 ~ b4 * Job_Satisfaction_T1\n  Life_Satisfaction_T3 ~ b5 * Job_Satisfaction_T2\n  Life_Satisfaction_T4 ~ b6 * Job_Satisfaction_T3\n'\n```\n:::\n\n\n#### Fit Model\n\n::: {.cell hash='8_Tutorials_AutoregressiveCrosslaggedPanelModels_cache/html/unnamed-chunk-5_87c986ecf88191762bff870016cf1f41'}\n\n```{.r .cell-code}\n# Fitting the model\nfit <- sem(model, data = data)\n```\n:::\n\n\n#### Model Summary\n\n::: {.cell hash='8_Tutorials_AutoregressiveCrosslaggedPanelModels_cache/html/unnamed-chunk-6_f89d73abf470e3f5cfc5e841eff6d471'}\n\n```{.r .cell-code}\n# Summarizing the model\nsummary(fit, fit.measures = TRUE, standardized = TRUE, rsquare = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nlavaan 0.6.16 ended normally after 12 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        19\n\n  Number of observations                           500\n\nModel Test User Model:\n                                                      \n  Test statistic                               110.474\n  Degrees of freedom                                14\n  P-value (Chi-square)                           0.000\n\nModel Test Baseline Model:\n\n  Test statistic                               214.805\n  Degrees of freedom                                27\n  P-value                                        0.000\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.486\n  Tucker-Lewis Index (TLI)                       0.009\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -5846.702\n  Loglikelihood unrestricted model (H1)      -5791.465\n                                                      \n  Akaike (AIC)                               11731.404\n  Bayesian (BIC)                             11811.481\n  Sample-size adjusted Bayesian (SABIC)      11751.174\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.117\n  90 Percent confidence interval - lower         0.098\n  90 Percent confidence interval - upper         0.138\n  P-value H_0: RMSEA <= 0.050                    0.000\n  P-value H_0: RMSEA >= 0.080                    0.999\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.076\n\nParameter Estimates:\n\n  Standard errors                             Standard\n  Information                                 Expected\n  Information saturated (h1) model          Structured\n\nRegressions:\n                         Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all\n  Job_Satisfaction_T2 ~                                                       \n    Jb_Sts_T1 (a1)         -0.042    0.046   -0.925    0.355   -0.042   -0.042\n  Job_Satisfaction_T3 ~                                                       \n    Jb_Sts_T2 (a2)         -0.019    0.044   -0.424    0.672   -0.019   -0.019\n  Job_Satisfaction_T4 ~                                                       \n    Jb_Sts_T3 (a3)         -0.023    0.046   -0.494    0.621   -0.023   -0.022\n  Life_Satisfaction_T2 ~                                                      \n    Lf_Sts_T1 (a4)          0.246    0.045    5.504    0.000    0.246    0.240\n  Life_Satisfaction_T3 ~                                                      \n    Lf_Sts_T2 (a5)          0.342    0.044    7.813    0.000    0.342    0.330\n  Life_Satisfaction_T4 ~                                                      \n    Lf_Sts_T3 (a6)          0.153    0.043    3.533    0.000    0.153    0.156\n  Job_Satisfaction_T2 ~                                                       \n    Lf_Sts_T1 (b1)         -0.042    0.034   -1.246    0.213   -0.042   -0.056\n  Job_Satisfaction_T3 ~                                                       \n    Lf_Sts_T2 (b2)         -0.013    0.033   -0.390    0.697   -0.013   -0.017\n  Job_Satisfaction_T4 ~                                                       \n    Lf_Sts_T3 (b3)          0.043    0.032    1.321    0.186    0.043    0.059\n  Life_Satisfaction_T2 ~                                                      \n    Jb_Sts_T1 (b4)         -0.001    0.060   -0.009    0.992   -0.001   -0.000\n  Life_Satisfaction_T3 ~                                                      \n    Jb_Sts_T2 (b5)         -0.013    0.059   -0.224    0.822   -0.013   -0.009\n  Life_Satisfaction_T4 ~                                                      \n    Jb_Sts_T3 (b6)          0.024    0.061    0.392    0.695    0.024    0.017\n\nCovariances:\n                         Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all\n .Job_Satisfaction_T4 ~~                                                      \n   .Lif_Stsfctn_T4         -0.003    0.133   -0.023    0.981   -0.003   -0.001\n\nVariances:\n                   Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all\n   .Job_Stsfctn_T2    2.166    0.137   15.811    0.000    2.166    0.996\n   .Job_Stsfctn_T3    2.144    0.136   15.811    0.000    2.144    0.999\n   .Job_Stsfctn_T4    2.227    0.141   15.811    0.000    2.227    0.996\n   .Lif_Stsfctn_T2    3.727    0.236   15.811    0.000    3.727    0.942\n   .Lif_Stsfctn_T3    3.784    0.239   15.811    0.000    3.784    0.891\n   .Lif_Stsfctn_T4    3.963    0.251   15.811    0.000    3.963    0.975\n\nR-Square:\n                   Estimate\n    Job_Stsfctn_T2    0.004\n    Job_Stsfctn_T3    0.001\n    Job_Stsfctn_T4    0.004\n    Lif_Stsfctn_T2    0.058\n    Lif_Stsfctn_T3    0.109\n    Lif_Stsfctn_T4    0.025\n```\n:::\n:::\n\n::: {.cell hash='8_Tutorials_AutoregressiveCrosslaggedPanelModels_cache/html/unnamed-chunk-7_143dd5d76a0998cde2891298887ab41b'}\n\n```{.r .cell-code}\n## Creating variable (names) from output to be used for inline text\n\nestimates <- parameterEstimates(fit)\nJob_Sat_T1 <- estimates[estimates$lhs == \"Job_Satisfaction_T1\", \"est\"]\nLife_Sat_T1 <- estimates[estimates$lhs == \"Life_Satisfaction_T1\", \"est\"]\n\nJobT2_to_LifeT1 <- estimates$est[estimates$label == \"b1\"]\nLifeT2_to_JobT1 <- estimates$est[estimates$label == \"a1\"]\n```\n:::\n\n\n### Interpreting the Results\nAn Autoregressive cross-lagged panel model (ARCL) was used to explore the reciprocal relationship between Job Satisfaction and Life Satisfaction across multiple time points. This model allows us to understand how past values of a variable can predict its future values and how one variable can influence the future values of another variable.\n\nFrom the `sem` output, we can interpret:\n- Autoregressive paths: How past values of Job Satisfaction and Life Satisfaction predict their future values.\n  - Coefficient for Job Satisfaction from T1 to T2: 2.076064, -0.302096\n  - Coefficient for Life Satisfaction from T1 to T2: 3.777644\n  (and so on for other time points)\n- Cross-lagged paths: How Job Satisfaction influences future values of Life Satisfaction and vice versa.\n  - Coefficient of Job Satisfaction at T1 influencing Life Satisfaction at T2: -0.0424807\n  - Coefficient of Life Satisfaction at T1 influencing Job Satisfaction at T2: -0.0424257\n  (and so on for other time points)\n\n\n\n\n## Conclusion\nThe ARCL model provides insights into the dynamic relationship between Job Satisfaction and Life Satisfaction. If the coefficients of the cross-lagged paths are significant, it suggests that there's a reciprocal influence between the two variables over time. The direction (positive or negative) and magnitude of these coefficients offer further understanding about the strength and nature of this relationship.\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
{
  "hash": "a87c78679007308dc7891cce16b5ffe4",
  "result": {
    "markdown": "---\ntitle: \"Generalized Estimating Equations\"\nauthor: \"Biostatistics Working Group\"\n---\n\n\n## Overview\nGeneralized estimating equations (GEEs) are a pivotal statistical methodology, designed specifically to analyze correlated data often encountered in longitudinal studies. GEEs have become a staple in a plethora of disciplines, spanning public health, epidemiology, and social sciences, because of their proficiency in managing repeated measurements on the same subjects. While reminiscent of the general linear model (GLM), GEEs extend their capabilities by addressing correlations within clusters of data, such as measurements within the same individual. This makes GEEs particularly invaluable for longitudinal data, where observations are chronologically ordered and dependencies between them are inherent. The essence of GEEs lies in their population-averaged approach, focusing on modeling the average response over individuals while accounting for within-subject correlations. Unlike models that emphasize subject-specific effects, GEEs provide insights into the broader trends across the population. This emphasis on population-level patterns, coupled with its adeptness at handling correlated data, solidifies GEEs as a cornerstone methodology for longitudinal analyses.\n\n### When to use Longitudinal Generalized Estimating Equations?\nYou should use longitudinal generalized estimating equations in the following scenario:\n\n1. You want to know: How the average outcome of a population evolves over time, especially when dealing with correlated or clustered data.\n2. Your variable: Is measured repeatedly across various time points or settings, capturing the inherent correlations within subjects.\n3. You have: Repeated measurements on subjects that could be correlated, and you're interested in the population-averaged effects rather than subject-specific effects.\n\n### Getting Started with Longitudinal Generalized Estimating Equations (GEEs)\nIn this tutorial, we will introduce the concept of longitudinal generalized estimating equations (GEEs) and guide you through a simple example using a small dataset. By the end of this tutorial, you will be able to:\n\n1. Understand the basic principles of generalized estimating equations in longitudinal settings.\n2. Fit a GEE model using example data in R.\n3. Analyze and interpreting the results from the GEE analysis.\n\n## Basic Example\nIn this tutorial, we will begin by generating a sample dataset directly within R to ensure everyone has the same starting point and can follow along without needing to download or access external files. This generated dataset will serve as our example throughout this tutorial. In your own analyses, you'll likely start by importing your own data.\n\nThe simulated dataset created for this example consists of scores on a single outcome variable (\"Job_Satisfaction\") for 500 individuals each measured at four time points: T1-T4.\n\n#### Create Example Dataset\n\n::: {.cell hash='6_Tutorials_GeneralizedEstimatingEquations_cache/html/unnamed-chunk-1_332e83a1134ce2a0ae83650ce9037190'}\n\n```{.r .cell-code}\n# This will create a dataset with 2000 rows (4 rows for each of the 500 individuals).\n\n# Setting the number of individuals for our sample data\nn <- 500\n\n# Specifying the desired correlation matrix for our data\ncor_matrix <- matrix(c(1, 0.30, 0.30, 0.30, \n                      0.30, 1, 0.30, 0.30, \n                      0.30, 0.30, 1, 0.30,\n                      0.30, 0.30, 0.30, 1),\n                      nrow=4)\n\n# Using Cholesky decomposition to generate correlated data\ncholesky <- chol(cor_matrix)\n\n# Generating correlated random data for 4 timepoints\nrandom_data <- matrix(rnorm(n * 4), ncol=4)\ncorrelated_data <- random_data %*% cholesky\n\n# Convert the correlated data to probabilities using the plogis function\ncorrelated_probs <- plogis(correlated_data)\n\n# Convert the probabilities to binary outcomes (using 0.5 as the threshold)\nbinary_outcomes <- ifelse(correlated_probs > 0.5, 1, 0)\n\n# Converting the generated data into a structured data frame\ndata_large <- data.frame(\n  Individual = rep(1:n, each=4),\n  TimePoint = rep(c(\"T1\", \"T2\", \"T3\", \"T4\"), times=n),\n  Job_Satisfaction = as.vector(t(binary_outcomes))\n)\n```\n:::\n\n\n#### View Dataset\n\n::: {.cell hash='6_Tutorials_GeneralizedEstimatingEquations_cache/html/unnamed-chunk-2_f70b71dc684a7c869199c0da7cd3951a'}\n\n```{.r .cell-code}\nhead(data_large)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Individual\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"TimePoint\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Job_Satisfaction\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"T1\",\"3\":\"0\",\"_rn_\":\"1\"},{\"1\":\"1\",\"2\":\"T2\",\"3\":\"0\",\"_rn_\":\"2\"},{\"1\":\"1\",\"2\":\"T3\",\"3\":\"1\",\"_rn_\":\"3\"},{\"1\":\"1\",\"2\":\"T4\",\"3\":\"1\",\"_rn_\":\"4\"},{\"1\":\"2\",\"2\":\"T1\",\"3\":\"1\",\"_rn_\":\"5\"},{\"1\":\"2\",\"2\":\"T2\",\"3\":\"1\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n### Model Specification and Estimation\nTo specify a Generalized Estimating Equation (GEE) model, we will utilize the `geepack` package in R. GEE models are designed to handle correlated data, making them suitable for longitudinal and other clustered data structures. In GEE, we focus on estimating the population-averaged effects of predictors while accounting for the within-cluster correlations using a specified working correlation structure.\n\n#### Install and Load Necessary Libraries\n\n::: {.cell hash='6_Tutorials_GeneralizedEstimatingEquations_cache/html/unnamed-chunk-3_b3500b8399f7605a47fcd798d4c54342'}\n\n```{.r .cell-code}\nif (!(\"geepack\" %in% installed.packages())) install.packages(\"geepack\")\nlibrary(geepack)\n```\n:::\n\n\n#### Model\n\n::: {.cell hash='6_Tutorials_GeneralizedEstimatingEquations_cache/html/unnamed-chunk-4_4f87274095df915b47a6dc0c17fcc2da'}\n\n```{.r .cell-code}\n# Running the model\nmodel <- geeglm(Job_Satisfaction ~ TimePoint, data = data_large, id = Individual, family = binomial(link = \"logit\"), corstr = \"exchangeable\")\n```\n:::\n\n\n#### Model Summary\n\n::: {.cell hash='6_Tutorials_GeneralizedEstimatingEquations_cache/html/unnamed-chunk-5_cd1ef6240c288a03a9b3f60e19608308'}\n\n```{.r .cell-code}\nprint(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\ngeeglm(formula = Job_Satisfaction ~ TimePoint, family = binomial(link = \"logit\"), \n    data = data_large, id = Individual, corstr = \"exchangeable\")\n\nCoefficients:\n(Intercept) TimePointT2 TimePointT3 TimePointT4 \n-0.10409389 -0.01605042  0.11209393  0.24834350 \n\nDegrees of Freedom: 2000 Total (i.e. Null);  1996 Residual\n\nScale Link:                   identity\nEstimated Scale Parameters:  [1] 1\n\nCorrelation:  Structure = exchangeable    Link = identity \nEstimated Correlation Parameters:\n    alpha \n0.1913765 \n\nNumber of clusters:   500   Maximum cluster size: 4 \n```\n:::\n:::\n\n\n### Interpreting the Results\nGeneralized Estimating Equations (GEE) were used to model the relationship between Job Satisfaction and TimePoint, taking into account the correlation of repeated measures within individuals. The model assumes a binomial distribution for Job Satisfaction with a logit link function and uses an exchangeable correlation structure. The output of the `geeglm` function provides estimates for the coefficients, along with their standard errors, Wald statistics, and p-values. The coefficient for `TimePoint` represents the change in the log odds of Job Satisfaction for a unit change in TimePoint.\n\nFor a detailed understanding, we can refer to:\n- Coefficient (Estimate) for `TimePoint`: NA\n- Associated p-value: NA\n\n## Conclusion\nIf the p-value for the `TimePoint` coefficient is less than 0.05, we can conclude that there is a statistically significant change in Job Satisfaction across the TimePoints according to the GEE model. Otherwise, we do not find evidence for such a change. The direction (increase or decrease) of this change can be determined by the sign of the coefficient for `TimePoint`.\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
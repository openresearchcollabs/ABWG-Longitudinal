{
  "hash": "0a813cbe39d4148dae10bf6c7e2d9212",
  "result": {
    "markdown": "---\ntitle: \"Linear Mixed Models\"\nauthor: \"Biostatistics Working Group\"\nexecute:\n  warning: false\n---\n\n\n## Overview\nLinear mixed models (LMMs) are a powerful statistical tool that allows the analysis of complex data structures that contain both fixed and random effects. LMMs are widely used in various fields, including social sciences, biology, and engineering, due to their ability to handle hierarchical data structures and account for within-subject correlations. LMMs are an extension of the general linear model (GLM), where both fixed and random effects can be included in the model, making them more flexible and robust. These models are particularly useful when analyzing longitudinal data, where measurements are taken repeatedly over time, and correlations between observations must be accounted for. Specifically, the LMM framework accounts for these dependencies among data by extending the general regression \"fixed effects\" model to allow both, fixed and random effects. This approach simultaneously models an overall sample mean trajectory (fixed effect) and subject-specific (random) effects that vary randomly about the sample mean trajectory. It is this \"mixture\" of fixed and random effects from which these models derive their name.\n\n![Linear Mixed Models](./figures/Linear Mixed Models.png)\n\n### When to use Longitudinal Linear Mixed Models (LMMs)?\nYou should consider using LMMs in the following situations:\n\n1. You want to know: The effects of interventions, time, or other predictors on a continuous outcome over multiple time points.\n2. Your data: Contains repeated measures taken on subjects at different time points or under various conditions.\n3. You have: Both fixed effects (overall population effects) and random effects (individual variations) that need to be accounted for in the analysis.\n\n### Getting Started with Longitudinal Linear Mixed Models\nIn this tutorial, we will introduce the concept of longitudinal linear mixed models (LLMMs) and guide you through a simple example using a small dataset. By the end of this tutorial, you will be able to:\n\n1. Understand the basic concepts of longitudinal linear mixed models.\n2. Fit a longitudinal linear mixed model using example data in R.\n3. Interpret the results of the LLMM analysis.\n\n## Basic Example\nIn this tutorial, we will begin by generating a sample dataset directly within R to ensure everyone has the same starting point and can follow along without needing to download or access external files. This generated dataset will serve as our example throughout this tutorial. In your own analyses, you'll likely start by importing your own data.\n\nThe simulated dataset created for this example consists of scores on a single outcome variable (\"Job_Satisfaction\") for 500 individuals each measured at four time points: T1-T4. \n\n#### Create Example Dataset\n\n::: {.cell hash='3_Tutorials_LinearMixedModels_cache/html/unnamed-chunk-1_f94da14ffb719c780e1f0b1eec96b257'}\n\n```{.r .cell-code}\n# This will create a dataset with 2000 rows (4 rows for each of the 500 individuals).\n\n# Setting the number of individuals for our sample data\nn <- 500\n\n# Specifying the desired correlation matrix for our data\ncor_matrix <- matrix(c(1, 0.30, 0.30, 0.30, \n                      0.30, 1, 0.30, 0.30, \n                      0.30, 0.30, 1, 0.30,\n                      0.30, 0.30, 0.30, 1),\n                      nrow=4)\n\n# Using Cholesky decomposition to generate correlated data\ncholesky <- chol(cor_matrix)\n\n# Generating correlated random data for 4 timepoints\nrandom_data <- matrix(rnorm(n * 4), ncol=4)\ncorrelated_data <- random_data %*% cholesky\n\n# Converting the generated data into a structured data frame\ndata_large <- data.frame(\n  Individual = rep(1:n, each=4),\n  TimePoint = rep(c(\"T1\", \"T2\", \"T3\", \"T4\"), times=n),\n  Job_Satisfaction = as.vector(t(correlated_data))\n)\n```\n:::\n\n\n#### View Dataset\n\n::: {.cell hash='3_Tutorials_LinearMixedModels_cache/html/unnamed-chunk-2_302196d7b51ebeed9a93aa491b98a403'}\n\n```{.r .cell-code}\nhead(data_large)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Individual\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"TimePoint\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Job_Satisfaction\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"T1\",\"3\":\"-1.8793925\",\"_rn_\":\"1\"},{\"1\":\"1\",\"2\":\"T2\",\"3\":\"-0.6134210\",\"_rn_\":\"2\"},{\"1\":\"1\",\"2\":\"T3\",\"3\":\"0.2235372\",\"_rn_\":\"3\"},{\"1\":\"1\",\"2\":\"T4\",\"3\":\"0.3236800\",\"_rn_\":\"4\"},{\"1\":\"2\",\"2\":\"T1\",\"3\":\"-0.3064703\",\"_rn_\":\"5\"},{\"1\":\"2\",\"2\":\"T2\",\"3\":\"-0.7016460\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n### Model Specification and Estimation\nTo specify a Linear Mixed Model (LMM), we will use the `lme4` package in R, specifically the `lmer` function. In LMMs, we account for both fixed effects, which are consistent across individuals, and random effects, which can vary. By doing so, LMMs allow us to model the trajectory of an outcome variable over time while considering the inter-individual differences and intra-individual changes.\n\n#### Install and Load Necessary Libraries\n\n::: {.cell hash='3_Tutorials_LinearMixedModels_cache/html/unnamed-chunk-3_a871a7943f42eb61072ba8a806e6127e'}\n\n```{.r .cell-code}\nif (!(\"lme4\" %in% installed.packages())) install.packages(\"lme4\")\nlibrary(lme4)\n```\n:::\n\n\n#### Model\n\n::: {.cell hash='3_Tutorials_LinearMixedModels_cache/html/unnamed-chunk-4_d236f39f1b263feb8d1b0f60e4700630'}\n\n```{.r .cell-code}\nmodel <- lmer(Job_Satisfaction ~ TimePoint + (1 | Individual), data = data_large)\n```\n:::\n\n\n#### Model Summary\n\n::: {.cell hash='3_Tutorials_LinearMixedModels_cache/html/unnamed-chunk-5_63c185baed6eccb82d74d047e62c9510'}\n\n```{.r .cell-code}\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear mixed model fit by REML ['lmerMod']\nFormula: Job_Satisfaction ~ TimePoint + (1 | Individual)\n   Data: data_large\n\nREML criterion at convergence: 5490\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.1846 -0.6437 -0.0167  0.6699  2.8774 \n\nRandom effects:\n Groups     Name        Variance Std.Dev.\n Individual (Intercept) 0.2905   0.5390  \n Residual               0.7102   0.8427  \nNumber of obs: 2000, groups:  Individual, 500\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept) -0.02551    0.04474  -0.570\nTimePointT2  0.10879    0.05330   2.041\nTimePointT3  0.03065    0.05330   0.575\nTimePointT4  0.01649    0.05330   0.309\n\nCorrelation of Fixed Effects:\n            (Intr) TmPnT2 TmPnT3\nTimePointT2 -0.596              \nTimePointT3 -0.596  0.500       \nTimePointT4 -0.596  0.500  0.500\n```\n:::\n\n```{.r .cell-code}\nplot(model)\n```\n\n::: {.cell-output-display}\n![](3_Tutorials_LinearMixedModels_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n### Interpreting the Results\nA Linear mixed model (LMM) was fitted to analyze the Job Satisfaction scores over different time points, accounting for random effects due to individual differences. By using the **summary()** function in R, we can obtain detailed results about the fixed and random effects. The TimePoint effect will indicate how Job Satisfaction varies across different time points. The model's coefficient for TimePoint (**r coef(model)['TimePoint']**) provides insights into the average change in Job Satisfaction for each unit increase in TimePoint. Its associated p-value (**r summary(model)$coefficients['TimePoint','Pr(>|t|)']**) will indicate its significance. Additionally, using the **plot()** function, we can visually inspect the diagnostic plots, which can give insights into the residuals' behavior, influential observations, and the model's overall fit.\n\n## Conclusion\nThe LMM allows us to analyze the trend in Job Satisfaction scores across time points while considering individual variability. Depending on the p-value for the TimePoint effect, we can determine if there's a statistically significant change in Job Satisfaction scores over the time points. Moreover, the diagnostic plots can guide potential model refinements or highlight areas for further investigation.\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}